<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CODOC - Sistema de Gestão</title>
    <link rel="icon" type="image/x-icon"
        href="data:image/x-icon;base64,AAABAAEAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAABILAAASCwAAAAAAAAAAAAD9/Pz/9vb2/7+/v/8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/9vb2/7+/v//9/f3/+/v7//n5+f/5+fn/+/v7/9vb2//7+/v/tbW1/1BQUP8AAAD/AAAA/wAAAP8AAAD/UFBA/7W1tf/7+/v/+fn5//n5+f/7+/v/vb29/9fX1/9LS0v/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/0tLS//X19f/e3t7//v7+//5+fn/+fn5//v7+//r6+v/j4+P/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP+Pj4//6+vr//v7+//5+fn/+fn5//v7+/+tra3/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/7W1tf/7+/v/+fn5//n5+f/7+/v/n5+f/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP+n5+f//v7+//5+fn/+fn5//v7+/+VlZX/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP+VlZX//v7+//5+fn/+fn5//v7+/+Li4v8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/+Li4v/7+/v/+fn5//n5+f/7+/v/l5eX/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/l5eX//v7+//5+fn/+fn5//v7+/+hoaH/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP+hoaH//v7+//5+fn/+fn5//v7+/+bm5v8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/+bm5v/7+/v/+fn5//n5+f/7VlZX/vb29/9fX1/9LS0v/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/0tLS//X19f/e3t7//v7+//5+fn/+fn5//v7+/+fn5/9vb2/7W1tf9QUFD/AAAA/wAAAP8AAAD/AAAA/1BQUP+1tbX/+fn5/9vb2//7+/v/+fn5//v7+/+vr6//9fX1/7+/v/8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/+/v7/9fX1//r6+v//v7+/wD4HwAA4AcAAMADAACAAQAAgAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIABAACAAQAAwAMAAMADAADgBwAA+B8AAA==">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        :root {
            --cor-primaria: #007bff;
            --cor-primaria-hover: #0056b3;
            --cor-secundaria: #28a745;
            --cor-secundaria-hover: #218838;
            --cor-admin: #6f42c1;
            --cor-admin-hover: #5a32a3;
            --cor-borda: #dee2e6;
            --cor-fundo: #f8f9fa;
            --cor-fundo-linha-hover: #e9ecef;
            --cor-erro: #dc3545;
            --cor-sucesso: #28a745;
            --cor-aviso: #ffc107;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--cor-fundo);
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .hidden {
            display: none !important;
        }

        /* --- Tela de Login --- */
        #login-container {
            width: 100%;
            max-width: 400px;
            padding: 2.5rem;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--cor-borda);
        }

        #login-container h1 {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin-top: 0;
            margin-bottom: 0.5rem;
        }

        #login-container h2 {
            font-size: 1.25rem;
            font-weight: 400;
            text-align: center;
            margin-bottom: 2rem;
            color: #6c757d;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input[type="email"],
        .form-group input[type="password"],
        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group input[type="date"],
        .form-group input[type="color"],
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            font-size: 1rem;
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
            box-sizing: border-box;
            /* Importante para padding não estourar a largura */
        }

        .form-group input[type="color"] {
            padding: 0.25rem;
            height: 40px;
        }

        .form-group input[type="checkbox"] {
            margin-right: 0.5rem;
        }
        
        /* Grupo de Input com Botão (Ex: Interessados) */
        .input-group-append {
            display: flex;
        }
        .input-group-append input {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
            flex: 1;
        }
        .input-group-append .button {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
            font-size: 1.2rem;
            padding-left: 1rem;
            padding-right: 1rem;
        }
        
        /* Lista de Itens Adicionados (Ex: Interessados) */
        .item-list {
            list-style: none;
            padding: 0;
            margin: 0.5rem 0 0 0;
            max-height: 120px;
            overflow-y: auto;
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
            background-color: var(--cor-fundo);
        }
        .item-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0.75rem;
            border-bottom: 1px solid var(--cor-borda);
            font-size: 0.9rem;
        }
        .item-list li:last-child {
            border-bottom: none;
        }
        .item-list .remove-item-btn {
            background-color: var(--cor-erro);
            color: white;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            line-height: 20px;
            text-align: center;
        }
        /* Fim dos estilos de Interessado */

        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .button {
            padding: 0.75rem 1rem;
            font-size: 0.9rem;
            font-weight: 600;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
            background-color: #6c757d;
            color: white;
            white-space: nowrap;
        }
        .button-small {
            padding: 0.5rem 0.8rem;
            font-size: 0.8rem;
        }

        .button-primary {
            background-color: var(--cor-primaria);
            color: white;
        }

        .button-primary:hover {
            background-color: var(--cor-primaria-hover);
        }

        .button-success {
            background-color: var(--cor-secundaria);
            color: white;
        }

        .button-success:hover {
            background-color: var(--cor-secundaria-hover);
        }

        .button-admin {
            background-color: var(--cor-admin);
            color: white;
            position: relative;
        }
        .button-admin:hover {
            background-color: var(--cor-admin-hover);
        }

        #login-status {
            text-align: center;
            margin-top: 1rem;
            font-weight: 500;
        }

        .status-error {
            color: var(--cor-erro);
        }

        .status-loading {
            color: #007bff;
        }

        .status-warning {
            color: var(--cor-aviso);
        }
        .status-success {
            color: var(--cor-sucesso);
        }

        /* --- Aplicação Principal (Container das Abas) --- */
        #main-app {
            width: 100%;
            height: 100vh;
            max-width: 1600px;
            margin: auto;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--cor-borda);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-sizing: border-box;
        }

        /* --- Cabeçalho Principal com Abas --- */
        #main-header {
            padding: 0 1.5rem;
            border-bottom: 1px solid var(--cor-borda);
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        #main-header h1 {
            font-size: 1.5rem;
            color: #333;
            margin-right: 2rem;
        }

        #tab-navigation {
            display: flex;
            border-bottom: none;
            margin-top: 10px;
        }

        .tab-link {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1rem;
            font-weight: 500;
            color: #6c757d;
            border-bottom: 3px solid transparent;
            margin-bottom: -1px;
        }

        .tab-link.active {
            color: var(--cor-primaria);
            border-bottom: 3px solid var(--cor-primaria);
        }

        #user-info-area {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.9rem;
            color: #6c757d;
        }

        /* Badge de Mensagens */
        #messages-btn {
            position: relative;
        }
        #message-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--cor-erro);
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
            border-radius: 50%;
            padding: 2px 6px;
            min-width: 10px;
            text-align: center;
        }

        /* --- Conteúdo das Abas --- */
        #tab-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .tab-pane {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .tab-pane:not(.active) {
            display: none;
        }

        /* --- Barra de Controlo (para ambas as abas) --- */
        .controls-bar {
            padding: 1.5rem;
            border-bottom: 1px solid var(--cor-borda);
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
            background-color: #fdfdfd;
        }

        .controls-bar input[type="search"] {
            flex: 1;
            min-width: 200px;
            padding: 0.75rem;
            font-size: 1rem;
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
        }

        .controls-bar .buttons-right {
            margin-left: auto;
            display: flex;
            gap: 1rem;
        }

        /* --- Controlos de Paginação --- */
        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-left: 1rem;
            color: #6c757d;
        }
        .pagination-controls button {
            padding: 0.5rem 0.8rem;
            font-size: 0.8rem;
        }
        .pagination-controls button:disabled {
            background-color: #e9ecef;
            cursor: not-allowed;
            color: #6c757d;
        }

        /* NOVO: Total de Registos */
        .records-info {
            margin-left: 1.5rem;
            font-size: 0.9rem;
            color: #6c757d;
        }

        /* --- Estilo para Botões de Ícone (Refresh) --- */
        #refresh-btn, #rec-refresh-btn {
            font-size: 1.3rem; /* Tamanho do ícone */
            padding: 0.5rem 0.8rem;
            line-height: 1.2;
        }
        
        /* --- Container da Tabela (para ambas as abas) --- */
        .table-container {
            flex: 1;
            overflow: auto;
        }

        .main-table {
            width: 100%;
            border-collapse: collapse;
        }

        /* --- CSS (Quebra de Linha) --- */
        .main-table th,
        .main-table td {
            padding: 0.9rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--cor-borda);
            font-size: 0.9rem;
            vertical-align: top;
        }

        .main-table th {
            background-color: var(--cor-fundo);
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            cursor: pointer;
        }

        /* Colunas que NUNCA quebram */
        .main-table [data-key="processo"],
        .main-table [data-key="docNumero"],
        .main-table [data-key="qtdCaixas"],
        .main-table [data-key="mensuracao"],
        .main-table [data-key="prazo"],
        .main-table [data-key="dataAbertura"],
        .main-table [data-key="classificacao"],
        .main-table [data-key="destinacao"],
        .main-table [data-key="numeroProcesso"],
        .main-table [data-key="color"],
        .main-table [data-key="foreground"],
        .main-table [data-key="actions"],
        .main-table [data-key="from"],
        .main-table [data-key="timestamp"],
        .main-table [data-key="dataPronto"],
        .main-table [data-key="status"],
        .main-table [data-key="role"] {
            white-space: nowrap;
        }

        /* Colunas que PODEM quebrar */
        .main-table [data-key="tipo"],
        .main-table [data-key="unidade"],
        .main-table [data-key="fase"],
        .main-table [data-key="linkPortal"],
        .main-table [data-key="obs"],
        .main-table [data-key="assuntoCapa"],
        .main-table [data-key="interessado"],
        .main-table [data-key="unidadeTransferiu"],
        .main-table [data-key="tags"],
        .main-table [data-key="name"],
        .main-table [data-key="keywords"],
        .main-table [data-key="tagName"],
        .main-table [data-key="email"] {
            white-space: normal;
            word-break: break-word;
            min-width: 150px;
            max-width: 350px;
        }
        /* --- FIM DAS REGRAS DE QUEBRA DE LINHA --- */

        .main-table tbody tr:hover {
            background-color: var(--cor-fundo-linha-hover);
        }

        /* Linhas clicáveis */
        #gestao-table-body tr,
        #color-management-table tbody tr,
        #view-messages-table tbody tr,
        #tag-management-table tbody td[data-key="tagName"],
        #rec-table-body tr {
            cursor: pointer;
        }

        .no-results-row td {
            text-align: center;
            padding: 2rem;
            color: #6c757d;
        }

        /* --- Modal (Janelas Toplevel) --- */
        .modal {
            display: none; 
            position: fixed; z-index: 1000;
            left: 0; top: 0; width: 100%; height: 100%;
            overflow: auto; background-color: rgba(0, 0, 0, 0.4);
            justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: #ffffff; margin: auto; padding: 2rem;
            border: 1px solid var(--cor-borda); border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            width: 90%; max-width: 600px; max-height: 90vh;
            overflow-y: auto; position: relative;
        }
        .modal-content-large { max-width: 900px; }
        .modal-content h2 { margin-top: 0; }
        .modal-close {
            position: absolute; top: 1rem; right: 1.5rem;
            font-size: 2rem; font-weight: 300; color: #aaa; cursor: pointer;
        }
        .modal-close:hover { color: #333; }
        .modal-form { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .modal-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .modal-menu .button { padding: 1.5rem; font-size: 1rem; }
        .form-group-full { grid-column: 1 / -1; }
        .modal-form textarea, .modal-content textarea {
            width: 100%; min-height: 80px; padding: 0.75rem;
            border: 1px solid var(--cor-borda); border-radius: 4px;
            box-sizing: border-box; font-family: inherit;
        }
        #view-messages-modal .main-table td { white-space: nowrap; }
        #view-messages-modal tr.unread td { font-weight: bold; }
        #message-content-view {
            margin-top: 1rem; padding: 1rem; background-color: var(--cor-fundo);
            border: 1px solid var(--cor-borda); border-radius: 4px;
            min-height: 150px; white-space: pre-wrap;
        }
        /* Lista de Etapas */
        #steps-list li.selected { background-color: var(--cor-fundo-linha-hover); }

        /* --- Global Toast --- */
        #global-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 9999;
            font-weight: 500;
            font-size: 1rem;
            transition: opacity 0.3s, transform 0.3s;
            opacity: 0;
            transform: translateX(100%);
            pointer-events: none;
        }
        #global-toast.show {
            opacity: 1;
            transform: translateX(0);
            pointer-events: all;
        }
        #global-toast.hidden {
            opacity: 0;
            transform: translateX(100%);
            pointer-events: none;
        }
        #global-toast.success {
            background-color: var(--cor-sucesso);
            color: white;
        }
        #global-toast.error {
            background-color: var(--cor-erro);
            color: white;
        }
        #global-toast.warning {
            background-color: var(--cor-aviso);
            color: #333;
        }

    </style>
</head>

<body>

    <div id="global-toast" class="hidden"></div>

    <div id="login-container">
        <h1>CODOC</h1>
        <h2>Sistema de Gestão</h2>
        <div class="form-group"> <label for="login-email">Email:</label> <input type="email" id="login-email" autocomplete="email"> </div>
        <div class="form-group"> <label for="login-password">Senha:</label> <input type="password" id="login-password" autocomplete="current-password"> </div>
        <div class="form-group"> <input type="checkbox" id="login-remember"> <label for="login-remember">Lembrar-me</label> </div>
        <div id="login-status"></div>
        <div class="button-group"> <button id="login-btn" class="button button-primary">Login</button> <button id="register-open-btn" class="button">Registar</button> </div>
    </div>

    <div id="main-app" class="hidden">
        <header id="main-header">
            <h1>CODOC</h1>
            <nav id="tab-navigation">
                <button class="tab-link active" data-tab="recuperacao-tab">Recuperação de Documentos</button>
            </nav>
            <div id="user-info-area">
                <span id="user-info">Utilizador: </span>
                <button id="messages-btn" class="button"> Mensagens <span id="message-badge" class="hidden">0</span> </button>
                <button id="admin-btn" class="button button-admin hidden">Admin</button>
                <button id="logout-btn" class="button">Sair</button>
            </div>
        </header>

        <main id="tab-content">
            <div id="recuperacao-tab" class="tab-pane active">
                <div class="controls-bar">
                    <input type="search" id="rec-search-input" placeholder="Pesquisar documentos...">
                    <button id="rec-search-btn" class="button button-primary">Pesquisar</button>
                    
                    <button id="open-filter-btn" class="button">Filtros</button>
                    <button id="rec-clear-filters-btn" class="button">Limpar Filtros</button>

                    <button id="rec-refresh-btn" class="button" title="Atualizar Lista">&#x21bb;</button>
                    
                    <div class="pagination-controls">
                        <button id="rec-prev-btn" class="button button-small" disabled>&lt; Anterior</button>
                        <span>Página <strong id="rec-page-num">1</strong> de <span id="rec-total-pages">1</span></span>
                        <button id="rec-next-btn" class="button button-small" disabled>Próxima &gt;</button>
                    </div>

                    <div class="records-info">
                        (Total: <strong id="rec-total-records">0</strong>)
                    </div>

                    <div class="buttons-right">
                        <button id="rec-delete-selected-btn" class="button hidden" style="background-color: var(--cor-erro);">Remover Selecionados (0)</button>
                        <button id="import-rec-btn" class="button">Importar (CSV/Excel)</button>
                        <input type="file" id="import-rec-input" class="hidden" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
                        <button id="open-recuperacao-form-btn" class="button button-success">Adicionar Registo</button>
                    </div>
                </div>
                <div class="table-container">
                    <table id="recuperacao-table" class="main-table">
                        <thead>
                            <tr>
                                <!-- NOVA COLUNA DE CHECKBOX ADICIONADA AQUI -->
                                <th style="width: 40px; text-align: center;"><input type="checkbox" id="rec-select-all-check"></th>
                    
                                <th data-key="numeroProcesso">Nº Processo</th>
                                <th data-key="assuntoCapa">Assunto Capa</th>
                                <th data-key="interessado">Interessado</th>
                                <th data-key="unidadeTransferiu">Unidade</th>
                                <th data-key="dataAbertura">Data Abertura</th>
                                <th data-key="classificacao">Classificação</th>
                                <th data-key="destinacao">Destinação</th>
                                <th data-key="tags">Tags</th>
                            </tr>
                        </thead>
                        <tbody id="rec-table-body"></tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <div id="filter-modal" class="modal">
        <div class="modal-content modal-content-large">
            <span class="modal-close" data-modal-id="filter-modal">&times;</span>
            <h2>Filtros Avançados</h2>
            <form id="filter-form" class="modal-form">
                <div class="form-group">
                    <label for="filter-unidade">Unidade (Origem):</label>
                    <select id="filter-unidade">
                        <option value="">Todas</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filter-interessado">Interessado (contém):</label>
                    <input type="text" id="filter-interessado" placeholder="Nome do interessado...">
                </div>
                <div class="form-group">
                    <label for="filter-atividade">Atividade:</label>
                    <select id="filter-atividade">
                        <option value="">Todas</option>
                        <option value="fim">Atividade-Fim</option>
                        <option value="meio">Atividade-Meio</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filter-destinacao">Destinação Final:</label>
                    <select id="filter-destinacao">
                        <option value="">Todas</option>
                    </select>
                </div>
                <div class="form-group form-group-full">
                    <label for="filter-classificacao">Código de Classificação:</label>
                    <select id="filter-classificacao">
                        <option value="">Todos</option>
                    </select>
                </div>
                <div class="form-group form-group-full">
                    <label for="filter-situacao">Situação do Prazo:</label>
                    <select id="filter-situacao">
                        <option value="">Todas</option>
                    </select>
                </div>
                <div class="form-group form-group-full">
                    <label for="filter-tags">Tags (contém):</label>
                    <input type="text" id="filter-tags" placeholder="Ex: financeiro, rh">
                </div>
                <hr style="grid-column: 1 / -1; border-top: 1px solid var(--cor-borda); border-bottom: none;">
                <div class="form-group">
                    <label for="filter-ano-abertura">Ano Abertura (Ex: 2023):</label>
                    <input type="number" id="filter-ano-abertura" placeholder="YYYY">
                </div>
                <div class="form-group">
                    <label>Data Abertura (Intervalo):</label>
                    <div style="display: flex; gap: 5px;">
                         <input type="date" id="filter-data-abertura-start" style="width: 50%;">
                         <input type="date" id="filter-data-abertura-end" style="width: 50%;">
                    </div>
                </div>
            </form>
            <div class="button-group">
                <button id="apply-filters-btn" class="button button-primary">Aplicar Filtros</button>
            </div>
        </div>
    </div>

    <div id="confirm-modal" class="modal">
        <div class="modal-content" style="max-width: 450px;">
            <span class="modal-close" data-modal-id="confirm-modal">&times;</span>
            <h2 id="confirm-modal-title">Confirmar Ação</h2>
            <p id="confirm-modal-message">Tem a certeza?</p>
            <div class="button-group">
                <button id="confirm-modal-cancel-btn" class="button">Cancelar</button>
                <button id="confirm-modal-ok-btn" class="button button-primary" style="margin-left: auto;">Confirmar</button>
            </div>
        </div>
    </div>

    <div id="register-modal" class="modal"> <div class="modal-content"> <span class="modal-close" data-modal-id="register-modal">&times;</span> <h2>Criar Nova Conta</h2> <div class="form-group"> <label for="register-name">Nome Completo:</label> <input type="text" id="register-name"> </div> <div class="form-group"> <label for="register-email">Email:</label> <input type="email" id="register-email"> </div> <div class="form-group"> <label for="register-password">Senha (mínimo 6):</label> <input type="password" id="register-password"> </div> <div class="form-group"> <label for="register-confirm-password">Confirmar Senha:</label> <input type="password" id="register-confirm-password"> </div> <div id="register-status"></div> <div class="button-group"> <button id="register-submit-btn" class="button button-primary">Registar</button> </div> </div> </div>
    
    <div id="recuperacao-form-modal" class="modal"> <div class="modal-content"> <span class="modal-close" data-modal-id="recuperacao-form-modal">&times;</span>
        <h2 id="recuperacao-modal-title">Registo/Recuperação Docs</h2> 
        <p>Registe processos arquivados.</p> 
        <form id="recuperacao-form" class="modal-form"> 
            <input type="hidden" id="rec-doc-id"> 
            <div class="form-group form-group-full"> <label for="rec-numero-processo">Nº Processo:</label> <input type="text" id="rec-numero-processo" required> </div> 
            
            <div class="form-group form-group-full"> <label for="rec-assunto-capa">Assunto Capa:</label> <input type="text" id="rec-assunto-capa"> </div> 
            
            <div class="form-group form-group-full">
                <label for="rec-interessado-input">Interessados:</label>
                <div class="input-group-append">
                    <input type="text" id="rec-interessado-input" placeholder="Adicionar nome...">
                    <button type="button" id="rec-interessado-add-btn" class="button button-primary">+</button>
                </div>
                <ul id="rec-interessado-list" class="item-list">
                    </ul>
            </div>
            
            <div class="form-group"> <label for="rec-unidade-transferiu">Unidade Origem:</label> <input type="text" id="rec-unidade-transferiu"> </div> <div class="form-group"> <label for="rec-data-transferencia">Data Transf. (LTD):</label> <input type="date" id="rec-data-transferencia"> </div> 
            
            <div class="form-group"> <label for="rec-data-abertura">Data Abertura:</label> <input type="date" id="rec-data-abertura"> </div> 
            
            <div class="form-group hidden" id="rec-ano-vigencia-group"> <label for="rec-ano-vigencia">Ano Fim Vigência:</label> <input type="number" id="rec-ano-vigencia" placeholder="YYYY"> </div> 
            
            <div class="form-group">
                <label for="rec-tipo-atividade">Atividade:</label>
                <select id="rec-tipo-atividade">
                    <option value="">Selecione...</option>
                    <option value="fim">Atividade-Fim</option>
                    <option value="meio">Atividade-Meio</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="rec-classificacao">Classificação:</label>
                <select id="rec-classificacao" required>
                    <option value="">Selecione a Atividade</option>
                </select>
            </div>
            
            <div class="form-group"> <label for="rec-destinacao-final">Destinação Final:</label> <select id="rec-destinacao-final"> <option value="">Selecione...</option> <option value="Guarda Permanente">Guarda Permanente</option> <option value="Eliminação">Eliminação</option> </select> </div> 
            
            <div class="form-group hidden" id="rec-data-eliminacao-group"> <label for="rec-data-eliminacao">Data Eliminação:</label> <input type="date" id="rec-data-eliminacao"> </div> 
            
            <div class="form-group form-group-full" id="rec-situacao-group" style="margin-top: 1rem;">
                <label for="rec-situacao">Situação do Prazo:</label>
                <input type="text" id="rec-situacao" readonly style="font-weight: bold; background-color: #e9ecef; color: #333; text-align: center;">
            </div>

            <div class="form-group form-group-full"> <label for="rec-tags">Tags (separadas por vírgula):</label> <input type="text" id="rec-tags" placeholder="Ex: financeiro, rh"> </div> 
        </form> 
        <div id="recuperacao-status" class="status-success" style="margin-bottom: 1rem;"></div> 
        <div class="button-group"> 
            <button id="recuperacao-save-btn" class="button button-success">Salvar Registo</button> 
            <button id="recuperacao-delete-btn" class="button hidden" style="background-color: var(--cor-erro); margin-left: auto;">Remover</button>
        </div> 
    </div> </div>

    <div id="admin-modal" class="modal"> <div class="modal-content"> <span class="modal-close" data-modal-id="admin-modal">&times;</span> <h2>Painel de Administração</h2> <div class="modal-menu"> 
        <button id="admin-gestao-tags-btn" class="button button-admin">Gerir Tags (Rec.)</button> 
        <button id="admin-enviar-msg-btn" class="button button-admin">Enviar Mensagem</button> 
        <button id="admin-gestao-users-btn" class="button button-admin">Gerir Utilizadores</button> 
        </div> </div> </div>
    
    <div id="view-messages-modal" class="modal"> <div class="modal-content modal-content-large"> <span class="modal-close" data-modal-id="view-messages-modal">&times;</span> <h2>Caixa de Entrada</h2> <div class="table-container" style="max-height: 250px;"> <table id="view-messages-table" class="main-table"> <thead> <tr> <th data-key="from">De</th> <th data-key="timestamp">Data</th> </tr> </thead> <tbody id="view-messages-table-body"></tbody> </table> </div> <h3>Conteúdo:</h3> <div id="message-content-view"> <p>Selecione uma mensagem.</p> </div> </div> </div>
    <div id="send-message-modal" class="modal"> <div class="modal-content"> <span class="modal-close" data-modal-id="send-message-modal">&times;</span> <h2>Enviar Mensagem</h2> <form id="send-message-form"> <div class="form-group"> <label for="send-message-recipient">Destinatário:</label> <select id="send-message-recipient" required> <option value="">Carregando...</option> </select> </div> <div class="form-group"> <label for="send-message-content">Mensagem:</label> <textarea id="send-message-content" rows="6" required></textarea> </div> </form> <div id="send-message-status"></div> <div class="button-group"> <button id="send-message-btn" class="button button-primary">Enviar</button> </div> </div> </div>
    
    <div id="tag-management-modal" class="modal"> <div class="modal-content"> <span class="modal-close" data-modal-id="tag-management-modal">&times;</span> <h2>Gerir Tags (Rec.)</h2> <p>Tags pré-definidas p/ recuperação.</p> <div class="table-container" style="max-height: 400px; margin-bottom: 1rem;"> <table id="tag-management-table" class="main-table"> <thead> <tr> <th data-key="tagName">Nome</th> <th data-key="actions" style="width: 80px;">Ações</th> </tr> </thead> <tbody id="tag-management-table-body"></tbody> </table> </div> <div class="button-group"> <button id="add-new-tag-btn" class="button button-primary">Adicionar</button> </div> </div> </div>
    <div id="tag-edit-modal" class="modal"> <div class="modal-content" style="max-width: 400px;"> <span class="modal-close" data-modal-id="tag-edit-modal">&times;</span> <h2 id="tag-edit-modal-title">Adicionar</h2> <form id="tag-edit-form"> <input type="hidden" id="tag-edit-id"> <div class="form-group"> <label for="tag-edit-name">Nome:</label> <input type="text" id="tag-edit-name" required> </div> </form> <div id="tag-edit-status" class="status-error" style="margin-bottom: 1rem;"></div> <div class="button-group"> <button id="save-tag-btn" class="button button-primary">Salvar</button> </div> </div> </div>
    <div id="user-management-modal" class="modal"> <div class="modal-content modal-content-large"> <span class="modal-close" data-modal-id="user-management-modal">&times;</span> <h2>Gerir Utilizadores</h2> <div class="table-container" style="max-height: 400px; margin-bottom: 1rem;"> <table id="user-management-table" class="main-table"> <thead> <tr> <th data-key="name">Nome</th> <th data-key="email">Email</th> <th data-key="status">Status</th> <th data-key="role">Função</th> <th data-key="actions">Ações</th> </tr> </thead> <tbody id="user-management-table-body"></tbody> </table> </div> <div class="button-group"> <button id="refresh-users-btn" class="button">Atualizar</button> </div> </div> </div>
    </div>
    </div>
    
    <div id="batch-classify-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" data-modal-id="batch-classify-modal">&times;</span>
            <h2>Classificar em Lote</h2>
            <p>A classificação e destinação abaixo serão APLICADAS a todos os <strong id="batch-classify-count">0</strong> registos selecionados. As tags serão ADICIONADAS às existentes.</p>
            
            <form id="batch-classify-form" class="modal-form">
                <div class="form-group form-group-full">
                    <label for="batch-rec-tipo-atividade">Atividade:</label>
                    <select id="batch-rec-tipo-atividade">
                        <option value="">Selecione...</option>
                        <option value="fim">Atividade-Fim</option>
                        <option value="meio">Atividade-Meio</option>
                    </select>
                </div>
                <div class="form-group form-group-full">
                    <label for="batch-rec-classificacao">Classificação (Obrigatório):</label>
                    <select id="batch-rec-classificacao" required>
                        <option value="">Selecione a Atividade</option>
                    </select>
                </div>
                <div class="form-group form-group-full">
                    <label for="batch-rec-destinacao-final">Destinação Final (Automática):</label>
                    <input type="text" id="batch-rec-destinacao-final" readonly>
                </div>
                <div class="form-group form-group-full">
                    <label for="batch-rec-tags-to-add">Tags (para ADICIONAR, separadas por vírgula):</label>
                    <input type="text" id="batch-rec-tags-to-add" placeholder="Ex: urgente, revisto">
                </div>
            </form>
            
            <div id="batch-classify-status" class="status-error" style="margin-bottom: 1rem;"></div>
            
            <div class="button-group">
                <button id="batch-classify-save-btn" class="button button-primary">Aplicar a Lote</button>
            </div>
        </div>
    </div>
    <script type="module">
    <script type="module">
        // Imports do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, setPersistence, browserLocalPersistence, browserSessionPersistence } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import { getDatabase, ref, set, get, child, push, update, remove, onValue } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";

        // Config do Firebase
        const firebaseConfig = { apiKey: "AIzaSyCU1XURVb8OP1g2YxBcg6fHLp5V49z6r9o", authDomain: "gestao-documental-processos.firebaseapp.com", projectId: "gestao-documental-processos", storageBucket: "gestao-documental-processos.firebasestorage.app", messagingSenderId: "153629260393", appId: "1:153629260393:web:cb0eb147d741f579b2c0f8", databaseURL: "https://gestao-documental-processos-default-rtdb.firebaseio.com" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);

        // ======================================================
        // ==== CÓDIGOS DE CLASSIFICAÇÃO (EDITAR AQUI) ====
        // ======================================================
        const classificacaoCodigos = {
            fim: {
                "01.01.01.01": { desc: "01.01.01.01 - Prontuário de cadastramento e atendimento de usuário", prazoCorrente: "Vigência", prazoIntermediario: 50, destinacao: "Eliminação" },
                "01.01.01.02": { desc: "01.01.01.02 - Formulário de avaliação de situação socioeconômica", prazoCorrente: 1, prazoIntermediario: 5, destinacao: "Eliminação" },
                "01.01.01.03": { desc: "01.01.01.03 - Declaração de situação de hipossuficiência", prazoCorrente: 1, prazoIntermediario: 0, destinacao: "Eliminação" },
                "01.01.01.04": { desc: "01.01.01.04 - Formulário do Núcleo de Audiência de Custódia - NUDAC", prazoCorrente: "Vigência", prazoIntermediario: 50, destinacao: "Eliminação" },
                "01.01.01.05": { desc: "01.01.01.05 - Formulário do Núcleo de Audiência de Apresentação - NAAP", prazoCorrente: 1, prazoIntermediario: 5, destinacao: "Eliminação" },
                "01.01.01.06": { desc: "01.01.01.06 - Carta de usuário", prazoCorrente: "Vigência", prazoIntermediario: 3, destinacao: "Eliminação" },
                "01.01.01.07": { desc: "01.01.01.07 - Ficha de cadastro para mediação", prazoCorrente: 2, prazoIntermediario: 3, destinacao: "Eliminação" },
                "01.01.01.08": { desc: "01.01.01.08 - Questionário facilitador da mediação", prazoCorrente: 2, prazoIntermediario: 3, destinacao: "Eliminação" },
                "01.01.02.01": { desc: "01.01.02.01 - Livro de protocolo", prazoCorrente: 1, prazoIntermediario: 5, destinacao: "Eliminação" },
                "01.01.02.02": { desc: "01.01.02.02 - Ofício de solicitação/requisição de informações, documentos, providências e outros", prazoCorrente: 3, prazoIntermediario: 2, destinacao: "Eliminação" },
                "01.01.02.03": { desc: "01.01.02.03 - Ofício de gratuidade para serviços", prazoCorrente: 3, prazoIntermediario: 2, destinacao: "Eliminação" },
                "01.01.02.04": { desc: "01.01.02.04 - Resposta de Ofício", prazoCorrente: 3, prazoIntermediario: 2, destinacao: "Eliminação" },
                "01.01.02.05": { desc: "01.01.02.05 - Ofício de encaminhamento para outro órgão da DP", prazoCorrente: 1, prazoIntermediario: 1, destinacao: "Eliminação" },
                "01.01.02.06": { desc: "01.01.02.06 - Ata de reunião em Tutela Coletiva", prazoCorrente: 3, prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "01.01.02.07": { desc: "01.01.02.07 - Termo de Registro de Depoimento", prazoCorrente: 3, prazoIntermediario: 2, destinacao: "Eliminação" },
                "01.01.02.08": { desc: "01.01.02.08 - Recomendação", prazoCorrente: 5, prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "01.01.02.09": { desc: "01.01.02.09 - Registro de Audiência Pública, Consulta Pública e Debates", prazoCorrente: 5, prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "01.01.02.10": { desc: "01.01.02.10 - Consulta jurídica", prazoCorrente: 1, prazoIntermediario: 1, destinacao: "Eliminação" },
                "01.01.02.11": { desc: "01.01.02.11 - Parecer", prazoCorrente: "Vigência", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "01.01.02.12": { desc: "01.01.02.12 - Procedimento para Comunicação de negativa de atendimento", prazoCorrente: "Vigência", prazoIntermediario: 10, destinacao: "Eliminação" },
                "01.01.03.01": { desc: "01.01.03.01 - Relatório de visita institucional", prazoCorrente: 5, prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "01.01.03.02": { desc: "01.01.03.02 - Relatório de fiscalização técnica", prazoCorrente: 5, prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "01.01.04.01": { desc: "01.01.04.01 - Procedimento de instrução de tutela coletiva", prazoCorrente: "Vigência", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "01.02.01.01": { desc: "01.02.01.01 - Ficha de acompanhamento de caso", prazoCorrente: "Vigência", prazoIntermediario: 5, destinacao: "Eliminação" },
                "01.02.01.02": { desc: "01.02.01.02 - Termo de compromisso com a mediação", prazoCorrente: 3, prazoIntermediario: 10, destinacao: "Eliminação" },
                "01.02.01.03": { desc: "01.02.01.03 - Termo de encerramento da mediação", prazoCorrente: 3, prazoIntermediario: 10, destinacao: "Eliminação" },
                "01.02.01.04": { desc: "01.02.01.04 - Termo de acordo extrajudicial", prazoCorrente: 3, prazoIntermediario: 27, destinacao: "Guarda Permanente" },
                "01.02.01.05": { desc: "01.02.01.05 - Relatório de finalização de caso da mediação", prazoCorrente: 3, prazoIntermediario: 10, destinacao: "Eliminação" },
                "01.02.01.06": { desc: "01.02.01.06 - Formulário de estatística mensal da mediação", prazoCorrente: 5, prazoIntermediario: 0, destinacao: "Guarda Permanente" },
                "01.02.01.07": { desc: "01.02.01.07 - Termo de responsabilidade e compromisso de mediador extrajudicial", prazoCorrente: "Vigência", prazoIntermediario: 10, destinacao: "Eliminação" },
                "01.02.01.08": { desc: "01.02.01.08 - Termo de adesão de mediador extrajudicial voluntário", prazoCorrente: "Vigência", prazoIntermediario: 10, destinacao: "Eliminação" },
                "01.02.01.09": { desc: "01.02.01.09 - Formulário de controle de horas de mediação", prazoCorrente: 10, prazoIntermediario: 0, destinacao: "Eliminação" },
                "01.02.01.10": { desc: "01.02.01.10 - Certificado de horas de mediação", prazoCorrente: 5, prazoIntermediario: 90, destinacao: "Eliminação" },
                "02.01.01.01": { desc: "02.01.01.01 - Petição protocolada em demanda individual - processo físico", prazoCorrente: 3, prazoIntermediario: 2, destinacao: "Eliminação" },
                "02.01.01.02": { desc: "02.01.01.02 - Protocolo de petição processual em demanda individual - processo eletrônico", prazoCorrente: 3, prazoIntermediario: 2, destinacao: "Eliminação" },
                "02.01.01.03": { desc: "02.01.01.03 - Procedimento referente ao pedido de análise de cabimento de Revisão Criminal", prazoCorrente: "Vigência", prazoIntermediario: 50, destinacao: "Eliminação" },
                "02.01.01.04": { desc: "02.01.01.04 - Procedimento referente ao pedido de análise de cabimento de Ação Rescisória", prazoCorrente: 2, prazoIntermediario: 3, destinacao: "Eliminação" },
                "02.01.01.05": { desc: "02.01.01.05 - Comunicado de prisão", prazoCorrente: 1, prazoIntermediario: 0, destinacao: "Eliminação" },
                "02.01.01.06": { desc: "02.01.01.06 - Comunicado de apreensão de adolescente", prazoCorrente: 1, prazoIntermediario: 0, destinacao: "Eliminação" },
                "02.01.01.07": { desc: "02.01.01.07 - Agenda de audiências judiciais", prazoCorrente: 1, prazoIntermediario: 4, destinacao: "Eliminação" },
                "02.02.01.01": { desc: "02.02.01.01 - Petição protocolada em demanda coletiva - processo físico", prazoCorrente: 3, prazoIntermediario: 2, destinacao: "Eliminação" },
                "02.02.01.02": { desc: "02.02.01.02 - Protocolo de petição processual em demanda coletiva - processo eletrônico", prazoCorrente: 3, prazoIntermediario: 2, destinacao: "Eliminação" },
                "02.02.01.03": { desc: "02.02.01.03 - Planilha de cadastro de ação judicial coletiva, procedimento de instrução instaurado e termos de ajustamento de conduta", prazoCorrente: "Vigência", prazoIntermediario: 0, destinacao: "Guarda Permanente" },
                "02.02.02.01": { desc: "02.02.02.01 - Nota técnica de orientação de atuação", prazoCorrente: "Vigência", prazoIntermediario: 0, destinacao: "Guarda Permanente" },
                "03.01.01.01": { desc: "03.01.01.01 - Dossiê de orientação/informação para o atendimento de usuários", prazoCorrente: 1, prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "03.01.01.02": { desc: "03.01.01.02 - Relatório de realização de curso/oficina temático para usuário", prazoCorrente: 1, prazoIntermediario: 2, destinacao: "Guarda Permanente" }
            },
            meio: {
                "0-0-1": { desc: "0-0-1 - MODERNIZAÇÃO E REESTRUTURAÇÃO ADMINISTRATIVA Incluem-se documentos referentes aos projetos, estudos e normas relativos à organização e métodos, reestruturação administrativa e outros procedimentos que visem à modernização das atividades da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-0-2-1": { desc: "0-0-2-1 - PLANOS, PROGRAMAS E PROJETOS DE TRABALHO Incluem-se documentos referentes ao planejamento e aos planos, programas e projetos de trabalho relativos ao desenvolvimento das atividades científicas, técnicas e administrativas da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-0-3-1": { desc: "0-0-3-1 - RELATÓRIO DE ATIVIDADES INSTITUCIONAL (FINAL)", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-0-3-2": { desc: "0-0-3-2 - RELATÓRIO DE ATIVIDADES SETORIAL Refere-se a relatórios de atividades setoriais que estejam inseridos no relatório de atividades institucional final (completo).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-0-3-3": { desc: "0-0-3-3 - ESTATÍSTICA PARA SUBSIDIAR A ELABORAÇÃO DE RELATÓRIOS DE ATIVIDADES", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-0-4": { desc: "0-0-4 - FORMALIZAÇÃO DE ACORDO, AJUSTE, CONTRATO E/OU CONVÊNIO Inclusive Cooperação Técnica. // Incluem-se documentos referentes a um acordo, ajuste, contrato e/ou convênio, resultantes de licitação ou não, implementados ou não, tais como projetos, relatórios técnicos; prestações de conta e aditamentos, que abranjam a execução de várias atividades ao mesmo tempo.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-0-5-1": { desc: "0-0-5-1 - FISCALIZAÇÃO DECORRENTE DE ACORDO, AJUSTE, CONTRATO E/OU CONVÊNIO Inclusive Cooperação Técnica.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Eliminação" },
                "0-0-5-2": { desc: "0-0-5-2 - APURAÇÃO DE IRREGULARIDADE COMETIDA POR LICITANTE, FORNECEDOR OU PRESTADOR DE SERVIÇO", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Eliminação" },
                "0-0-6-1-1": { desc: "0-0-6-1-1 - Correição Ordinária e Extraordinária. Incluem-se documentos referentes aos procedimentos de averiguação ampla sobre atividades e procedimentos de trabalho das unidades da DPRJ e sobre a conduta funcional de seus Defensores e Servidores.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Eliminação" },
                "0-0-6-1-2": { desc: "0-0-6-1-2 - Inspeção Ordinária e Extraordinária de Corregedoria. Incluem-se documentos referentes aos procedimentos de averiguação de aspectos específicos sobre atividades e procedimentos de trabalho das unidades da DPRJ e sobre a conduta funcional de seus Defensores e Servidores.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Eliminação" },
                "0-0-6-1-3": { desc: "0-0-6-1-3 - Apuração de possível desvio de conduta. Inclusive acompanhamento e monitoramento. // Incluem-se documentos referentes a procedimentos de averiguação de desvio de conduta funcional de Defensor / Servidor que atente contra interesses de indivíduos, de instituições ou da Administração Pública ou contra o decoro ou a dignidade do cargo.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-0-6-2-1": { desc: "0-0-6-2-1 - Auditoria Ordinária e Extraordinária de Controle Interno.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Eliminação" },
                "0-0-6-2-2": { desc: "0-0-6-2-2 - Inspeção de Controle Interno. Incluem-se documentos referentes a inspeções internas da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Eliminação" },
                "0-0-6-2-3": { desc: "0-0-6-2-3 - Acompanhamento e monitoramento de Controle Interno. Incluem-se documentos referentes a acompanhamento e monitoramento de ações dos gestores da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Eliminação" },
                "0-0-6-3-1-1": { desc: "0-0-6-3-1-1 - Manifestação de interesse do cidadão. Incluem-se documentos referentes a demanda dos cidadãos relacionadas a informações, esclarecimentos, orientações sobre normas e posicionamentos da DPRJ sobre assuntos diversos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-0-6-3-1-2": { desc: "0-0-6-3-1-2 - Manifestação de interesse administrativo. Incluem-se documentos referentes a sugestões de melhoria, elogios, críticas ou reclamações sobre serviços prestados pela DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Eliminação" },
                "0-0-6-3-1-3": { desc: "0-0-6-3-1-3 - Manifestação sobre suposta irregularidade interna. Incluem-se documentos referentes à suposta irregularidade cometida por Defensor, Servidor, Residente Jurídico, terceirizado, estagiário ou contratado da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-0-6-3-2": { desc: "0-0-6-3-2 - Comunicação de Ouvidoria. Incluem-se documentos de comunicação às unidades competentes sobre a existência de indícios de suposta irregularidade praticada em atos de gestão da DPRJ, bem como de indícios de suposta prática de infração funcional.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Eliminação" },
                "0-0-7": { desc: "0-0-7 - SANÇÃO ADMINISTRATIVA Refere-se a processos que resultem imposição de sanção.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 25, destinacao: "Guarda Permanente" },
                "0-0-8-1": { desc: "0-0-8-1 - ACOMPANHAMENTO E INSTRUÇÃO DE AÇÃO JUDICIAL Incluem-se documentos referentes às ações judiciais onde a DPRJ é parte, tais como ações ordinárias, mandado de segurança e outros.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-0-9": { desc: "0-0-9 - ATUAÇÃO DE DEFENSOR PÚBLICO Incluem-se os documentos pertinentes aos questionamentos, comunicações e manifestações administrativas sobre a atuação de Defensor Público na atividade-fim (Ação Rescisória, Revisão Criminal, Suspeição, Impedimento, Consultas Jurídicas), bem como relatórios de pesquisa.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-1-0": { desc: "0-1-0 - ORGANIZAÇÃO E FUNCIONAMENTO Incluem-se elaboração de norma, regulamentação, diretriz, procedimento, estudo e/ou decisão de caráter geral referente à organização e funcionamento.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-1-0-1": { desc: "0-1-0-1 - REGISTRO NOS ÓRGÃOS COMPETENTES Incluem-se habilitação jurídica e regularização fiscal da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-1-0-2": { desc: "0-1-0-2 - REGIMENTO. REGULAMENTO. ESTATUTO. ORGANOGRAMA. ESTRUTURA", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-1-0-3": { desc: "0-1-0-3 - AUDIÊNCIA. DESPACHO. REUNIÃO (ASSUNTOS GERAIS)", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-1-1-1": { desc: "0-1-1-1 - COMISSÃO. CONSELHO. GRUPO DE TRABALHO. JUNTA. COMITÊ (ASSUNTOS GERAIS)", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-1-1-1-1": { desc: "0-1-1-1-1 - Ato de Criação / Extinção, Ata e Relatório de Comissão, Conselho, Grupo de Trabalho, Junta ou Comitê Incluem-se documentos referentes à criação de comissões, conselhos, grupos de trabalho, juntas e/ou comitês, na própria DPRJ ou em órgãos colegiados e de deliberação coletiva, bem como aqueles relativos ao exercício de suas funções, tais como: pronunciamento, recomendação, representação, requisição, atas, relatórios técnicos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-1-1-1-2": { desc: "0-1-1-1-2 - Comunicação de afastamento de membro de Órgão Colegiado.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-1-2-1-1": { desc: "0-1-2-1-1 - Credenciamento de jornalistas.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 1, destinacao: "Eliminação" },
                "0-1-2-1-2": { desc: "0-1-2-1-2 - Entrevista. Noticiário. Reportagem. Editorial.", prazoCorrente: 1, prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-1-2-1-3": { desc: "0-1-2-1-3 - Release de matérias (decisões) sobre a DPRJ a serem divulgadas pela imprensa. Notas e pautas.", prazoCorrente: 1, prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-1-2-1-4": { desc: "0-1-2-1-4 - Diário Oficial Eletrônico da DPRJ. Refere-se ao arquivo em suporte eletrônico gerado em sistema próprio da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 0, destinacao: "Guarda Permanente" },
                "0-1-2-2-1": { desc: "0-1-2-2-1 - Informativo Interno e Boletins. Incluem-se informativos e boletins administrativos, de pessoal e de serviço.", prazoCorrente: 1, prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-1-2-2-2": { desc: "0-1-2-2-2 - Clipping - compilação de notícias sobre a DPRJ.", prazoCorrente: 1, prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-1-2-3": { desc: "0-1-2-3 - CAMPANHA INSTITUCIONAL. PUBLICIDADE Incluem-se relatórios de avaliação de impacto e de pesquisa, bem como um exemplar de cada cartaz, folheto, anúncio, folder, bâner e outros documentos de caráter promocional.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 15, destinacao: "Guarda Permanente" },
                "0-1-2-4": { desc: "0-1-2-4 - REGISTRO SONORO, FOTOGRÁFICO E AUDIOVISUAL", prazoCorrente: 2, prazoIntermediario: 15, destinacao: "Guarda Permanente" },
                "0-1-3-1-1": { desc: "0-1-3-1-1 - Planejamento, programação, discursos, palestras e trabalhos apresentados por Defensor / Servidor da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-1-3-2-1": { desc: "0-1-3-2-1 - Planejamento, programação, discurso, palestra e trabalhos apresentados por Defensor / Servidor da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-1-3-2-2": { desc: "0-1-3-2-2 - Planejamento, norma, edital, habilitação de candidatos, julgamento da banca, trabalhos concorrentes, premiação e recursos em concurso. Refere-se à concurso.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-1-3-3": { desc: "0-1-3-3 - FELICITAÇÃO. CONVITE. AGRADECIMENTO. PÊSAMES. DESPEDIDA", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-1-3-4": { desc: "0-1-3-4 - VISITA E VISITANTE Incluem-se documentos referentes às solicitações de audiências, assistência, orientação e assessoramento a visitantes.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-1-3-4-1": { desc: "0-1-3-4-1 - Livro de registro de presença.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-1-3-5": { desc: "0-1-3-5 - PROTESTO. REIVINDICAÇÃO. RECLAMAÇÃO. SUGESTÃO", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-1-3-6": { desc: "0-1-3-6 - PEDIDO. OFERECIMENTO. INFORMAÇÃO DIVERSA", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-1-3-7": { desc: "0-1-3-7 - PREMIAÇÃO Refere-se a prêmios e elogios concedidos à DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-1-4-1": { desc: "0-1-4-1 - GESTÃO AMBIENTAL Incluem-se documentos referentes à programas socioambientais, campanhas e coleta seletiva.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-1-4-2": { desc: "0-1-4-2 - RESPONSABILIDADE SOCIAL Incluem-se documentos referentes à ações sociais, campanhas e acessibilidade.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-1-4-3": { desc: "0-1-4-3 - ASSISTÊNCIA SOCIAL Incluem-se documentos referentes à proposta de criação ou alteração de programas de assistência social.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-0-1": { desc: "0-2-0-1 - IDENTIFICAÇÃO FUNCIONAL Refere-se a carteira, cartão, crachá, credencial e outros documentos de identificação. // Incluem-se solicitação de atribuição de matrícula, solicitação de emissão de identificação funcional, comprovante de recebimento e identificação funcional recolhida.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-0-2": { desc: "0-2-0-2 - RELAÇÃO COM ÓRGÃO NORMATIZADOR DA ADMINISTRAÇÃO PÚBLICA Incluem-se obrigações trabalhistas e estatutárias.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-0-3": { desc: "0-2-0-3 - RELAÇÃO COM O CONSELHO PROFISSIONAL", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-0-4": { desc: "0-2-0-4 - RELAÇÃO COM SINDICATO / ASSOCIAÇÃO Incluem-se acordos e dissídios.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-2-0-4-1": { desc: "0-2-0-4-1 - Movimento reividicatório: greve e paralisação", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-2-0-5": { desc: "0-2-0-5 - RELAÇÃO COM ENTIDADES DE FINANCIAMENTO E DE CRÉDITO PESSOAL PARA DEFENSOR / SERVIDOR", prazoCorrente: "Enquanto vigora", prazoIntermediario: 20, destinacao: "Eliminação" },
                "0-2-0-5-1": { desc: "0-2-0-5-1 - Adiantamento e empréstimo a Defensor / Servidor.", prazoCorrente: "Até a quitação da dívida", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-0-6": { desc: "0-2-0-6 - ASSENTAMENTO FUNCIONAL. CADASTRO Incluem-se documentos referentes à vida funcional do Defensor / Servidor (pasta individual), ficha cadastral de ocorrências de pessoal, registros e/ou anotações no assentamento funcional, bem como inclusão / exclusão de dependentes.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 95, destinacao: "Eliminação" },
                "0-2-0-6-1": { desc: "0-2-0-6-1 - Dados Cadastrais - atualização e recadastramento. Incluem-se comunicação de mudança de nome, e alteração de endereço e telefone.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-0-6-2": { desc: "0-2-0-6-2 - Comunicação de endereço eventual. Incluem-se comunicações de endereço em que o Defensor / Servidor possam ser encontrados em casos de férias ou licença.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 1, destinacao: "Eliminação" },
                "0-2-0-6-3": { desc: "0-2-0-6-3 - Solicitação de certidões, declarações e averbação de documentos; de pedidos de informação sobre histórico funcional; e de pedidos de registros e/ou anotações no assentamento funcional.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-0-6-4": { desc: "0-2-0-6-4 - Carta de apresentação. Carta de recomendação.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 1, destinacao: "Eliminação" },
                "0-2-0-7": { desc: "0-2-0-7 - HORÁRIO DE EXPEDIENTE Inclui-se escala de plantão.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-0-7-1": { desc: "0-2-0-7-1 - Controle de frequência. Incluem-se livro de ponto, cartão de ponto, folha de ponto, controle eletrônico de ponto, mudança de carga horária, abono de faltas, ponto facultativo, cumprimento de hora extra e retificação de frequência.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 70, destinacao: "Eliminação" },
                "0-2-0-8-1": { desc: "0-2-0-8-1 - Prêmio. Incluem-se concessão de medalhas e diploma de honra ao mérito.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-2-0-8-2": { desc: "0-2-0-8-2 - Elogio a Defensor / Servidor.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 95, destinacao: "Eliminação" },
                "0-2-0-9": { desc: "0-2-0-9 - COMUNICADO E INFORME DIVERSO SOBRE GESTÃO DE PESSOAS Incluem-se comunicações de posse, afastamentos de cargo, concurso de remoção, mudanças de lotação, e outros.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-0-9-1": { desc: "0-2-0-9-1 - Informações sobre gestão de pessoas. Incluem-se pedidos de informações sobre política de pessoal, recursos humanos e departamento pessoal.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-1-1": { desc: "0-2-1-1 - CANDIDATO A CARGO PÚBLICO Incluem-se inscrição, curriculum vitae e prorrogação de posse.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-2-1-2": { desc: "0-2-1-2 - CONCURSO PÚBLICO PARA DEFENSOR / SERVIDOR (ASSUNTOS GERAIS)", prazoCorrente: "Enquanto Vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-1-2-1": { desc: "0-2-1-2-1 - Provas e títulos, testes psicotécnicos e exames médicos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 6, destinacao: "Eliminação" },
                "0-2-1-2-2": { desc: "0-2-1-2-2 - Constituição de banca examinadora, edital, exemplar único de prova, gabarito, resultado, revisão e recurso.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-2-2-1-1": { desc: "0-2-2-1-1 - Curso promovido pela DPRJ (assuntos gerais).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-2-2-1-1-1": { desc: "0-2-2-1-1-1 - Proposta, estudo, edital, programa, relatório final de curso promovido pela DPRJ, bem como exemplar único de material didático, relação de participantes, avaliação e controle de expedição de certificado.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Guarda Permanente" },
                "0-2-2-1-2": { desc: "0-2-2-1-2 - Curso promovido por outra instituição com ônus (assuntos gerais). Refere-se aos documentos que não envolvem pagamento.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-2-1-2-1": { desc: "0-2-2-1-2-1 - Curso com ônus promovido por outra instituição no Brasil. Refere-se aos documentos que envolvem pagamento.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-2-1-2-2": { desc: "0-2-2-1-2-2 - Curso com ônus promovido por outra instituição no Exterior. Refere-se aos documentos que envolvem pagamento.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-2-1-3-1": { desc: "0-2-2-1-3-1 - Curso sem ônus promovido por outra instituição no Brasil.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-2-1-3-2": { desc: "0-2-2-1-3-2 - Curso sem ônus promovido por outra instituição no Exterior.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-2-1-4": { desc: "0-2-2-1-4 - Comprovação de certificação profissional, graduação e pós-graduação.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-2-1-5": { desc: "0-2-2-1-5 - Processo seletivo interno de capacitação.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-2-2-1": { desc: "0-2-2-2-1 - Estágio promovido pela DPRJ (assuntos gerais). Inclusive Residência Jurídica e Estágio Forense. // Incluem-se documentos referentes a gestão dos estagiários jurídicos, técnicos e multidisciplinares que integram a equipe da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-2-2-1-1": { desc: "0-2-2-2-1-1 - Estudo, proposta, programa, avaliação, relação de participantes, declaração de comprovação e relatório final de estágio.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Guarda Permanente" },
                "0-2-2-2-2": { desc: "0-2-2-2-2 - Concurso para Residência Jurídica e Estágio Forense (assuntos gerais).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-2-2-2-1": { desc: "0-2-2-2-2-1 - Provas e títulos, testes psicotécnicos e exames médicos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 6, destinacao: "Eliminação" },
                "0-2-2-2-2-2": { desc: "0-2-2-2-2-2 - Constituição de banca examinadora, edital, exemplar único de prova e gabarito, recurso, resultado final, lista de classificação e convocação.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-2-2-2-3": { desc: "0-2-2-2-3 - Estágio promovido por outra instituição no Brasil ou no Exterior.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-2-3-1": { desc: "0-2-2-3-1 - Planejamento, programação, discursos, palestras e trabalhos apresentados por Defensor / Servidor da DPRJ.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-2-3-0-1": { desc: "0-2-3-0-1 - Estudo e previsão de pessoal. Incluem-se documentos referentes a pedidos de ampliação de pessoal / equipe técnica; adequação do quadro, indicativos de carência de pessoal", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-2-3-0-2": { desc: "0-2-3-0-2 - Criação, classificação, transformação, transposição e remuneração de cargos e funções.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-2-3-0-3": { desc: "0-2-3-0-3 - Reestruturação e alteração salarial. Incluem-se a ascensão e progressão funcional, avaliação de desempenho, o enquadramento, a equiparação, o reajuste e a reposição salarial e as promoções.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-3-0-3-1": { desc: "0-2-3-0-3-1 - Lista de Antiguidade.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-2-3-0-4": { desc: "0-2-3-0-4 - Estágio Probatório.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-3-1-1": { desc: "0-2-3-1-1 - Admissão. Aproveitamento. Contratação. Nomeação. Readmissão. Readaptação. Recondução. Reintegração. Reversão.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-3-1-2": { desc: "0-2-3-1-2 - Demissão. Dispensa. Exoneração. Rescisão contratual. Falecimento.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-3-1-3": { desc: "0-2-3-1-3 - Lotação. Remoção. Transferência. Permuta.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-3-1-3-1": { desc: "0-2-3-1-3-1 - Solicitação de lotação, remoção, transferência, permuta de Defensor / Servidor.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-3-1-4": { desc: "0-2-3-1-4 - Designação. Disponibilidade. Redistribuição. Substituição.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-3-1-5": { desc: "0-2-3-1-5 - Requisição. Cessão. Incluem-se documentos referentes às requisições e cessões internas e/ou externas de Defensor / Servidor para a realização de serviços temporários, bem como documentos referentes ao seu retorno ao órgão de origem.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-3-1-5-1": { desc: "0-2-3-1-5-1 - Solicitação de requisição ou de cessão de Defensor / Servidor.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-3-2": { desc: "0-2-3-2 - ELEIÇÃO Incluem-se documentos referentes às eleições no âmbito da administração superior - Defensoria Pública Geral do Estado, Conselho Superior da Defensoria Pública, Corregedoria-Geral da Defensoria Pública e Ouvidoria Geral da Defensoria Pública.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-2-4-1": { desc: "0-2-4-1 - FOLHA DE PAGAMENTO. FICHA FINANCEIRA", prazoCorrente: "Enquanto vigora", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-4-1-0": { desc: "0-2-4-1-0 - Folha de Pagamento. Ficha Financeira (assuntos gerais).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-4-1-0-1": { desc: "0-2-4-1-0-1 - Contra cheque. Incluem-se 2ª via e outros assuntos relacionados.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-4-1-0-2": { desc: "0-2-4-1-0-2 - Comunicação de débito pendente de Defensor / Servidor.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-4-1-1-1": { desc: "0-2-4-1-1-1 - Salário-família.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-4-1-1-2": { desc: "0-2-4-1-1-2 - Abono ou provento provisório.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-4-1-1-3": { desc: "0-2-4-1-1-3 - Abono de permanência em serviço.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-4-1-2-1": { desc: "0-2-4-1-2-1 - Gratificação de Função.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-2-2": { desc: "0-2-4-1-2-2 - Gratificação por Exercício de Cargo ou Cargo em Comissão.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-2-3": { desc: "0-2-4-1-2-3 - Gratificação Natalina (décimo terceiro salário).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-4-1-2-4": { desc: "0-2-4-1-2-4 - Gratificação de Desempenho.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-4-1-2-5": { desc: "0-2-4-1-2-5 - Gratificação por encargo de curso ou concurso.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-4-1-2-6": { desc: "0-2-4-1-2-6 - Gratificação de Acumulação.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-2-7": { desc: "0-2-4-1-2-7 - Gratificação pela participação em Órgão de Deliberação Coletiva. Incluem-se o Resumo de Autorização de Gratificação (RAG) e a Relação Mensal de Gratificação (RMG).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-3-1": { desc: "0-2-4-1-3-1 - Adicional de Tempo de Serviço. Inclui-se triênio e quinquênio.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 35, destinacao: "Guarda Permanente" },
                "0-2-4-1-3-2": { desc: "0-2-4-1-3-2 - Adicional Noturno.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-3-3": { desc: "0-2-4-1-3-3 - Adicional de Periculosidade.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-3-4": { desc: "0-2-4-1-3-4 - Adicional de Insalubridade.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-3-5": { desc: "0-2-4-1-3-5 - Adicional por Atividade Penosa.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-3-6": { desc: "0-2-4-1-3-6 - Adicional por Serviço Extraordinário (hora extra).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-3-7": { desc: "0-2-4-1-3-7 - Adicional de Férias. Incluem-se adicional de 1/3 e abono pecuniário.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-4-1-4-1": { desc: "0-2-4-1-4-1 - Desconto de Contribuição Sindical do Defensor / Servidor. Inclui-se desconto com Associações.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-4-1-4-2": { desc: "0-2-4-1-4-2 - Desconto de Contribuição para o plano de seguridade social (inclusive INSS, IPERJ, IASERJ, RIOPREVIDÊNCIA). Incluem-se documentos referentes a cancelamento, devolução, isenção de contribuição previdenciária / adesão, alteração de valor da parcela.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-4-3": { desc: "0-2-4-1-4-3 - Desconto de Imposto de Renda Retido na Fonte (IRRF). Incluem-se recadastramento, inclusão e isenção de imposto de renda.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-4-1-4-4": { desc: "0-2-4-1-4-4 - Desconto de Pensão Alimentícia.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-4-1-4-5": { desc: "0-2-4-1-4-5 - Consignação. Incluem-se documentos de averbação de consignação em folha de empréstimo e outros.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-4-1-5-1": { desc: "0-2-4-1-5-1 - Programa de Formação do Patrimônio do Servidor Público (PASEP). Programa de Integração Social (PIS).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-4-1-5-2": { desc: "0-2-4-1-5-2 - Fundo de Garantia por Tempo de Serviço (FGTS).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-1-5-3": { desc: "0-2-4-1-5-3 - Contribuição para o Plano de Seguridade Social - recolhimento. Incluem-se contribuições anteriores.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-4-1-5-4": { desc: "0-2-4-1-5-4 - Imposto de Renda.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-4-2": { desc: "0-2-4-2 - FÉRIAS (ASSUNTOS GERAIS) Incluem-se documentos referentes a recolhimento, escala, marcação, adiamento, transferência, desistência, interrupção e cancelamento.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-4-2-1": { desc: "0-2-4-2-1 - Concessão individual de férias. Incluem-se atos específicos e individuais de Defensor / Servidor.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 95, destinacao: "Eliminação" },
                "0-2-4-3-1": { desc: "0-2-4-3-1 - Licença por motivo de aborto.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-3-10": { desc: "0-2-4-3-10 - Licença à gestante.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-11": { desc: "0-2-4-3-11 - Licença-natimorto.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-12": { desc: "0-2-4-3-12 - Licença-paternidade.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-13": { desc: "0-2-4-3-13 - Licença-prêmio por Assiduidade (Licença Especial)", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-14": { desc: "0-2-4-3-14 - Licença para serviço militar.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-15": { desc: "0-2-4-3-15 - Licença para tratamento de interesse particular.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-16": { desc: "0-2-4-3-16 - Licença para tratamento de saúde (inclusive perícia médica).", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-2": { desc: "0-2-4-3-2 - Licença por motivo de acidente em serviço.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-3": { desc: "0-2-4-3-3 - Licença à adotante.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-4": { desc: "0-2-4-3-4 - Licença por motivo de afastamento do cônjuge / companheiro.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-5": { desc: "0-2-4-3-5 - Licença para aleitamento materno.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-6": { desc: "0-2-4-3-6 - Licença para atividade política.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-7": { desc: "0-2-4-3-7 - Licença para capacitação profissional.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-8": { desc: "0-2-4-3-8 - Licença para desempenho de mandato classista.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-3-9": { desc: "0-2-4-3-9 - Licença por motivo de doença em pessoa da família.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-4-1": { desc: "0-2-4-4-1 - Afastamento para curso de formação.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-4-2": { desc: "0-2-4-4-2 - Afastamento para depor.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-4-3": { desc: "0-2-4-4-3 - Afastamento para estágio experimental em outro cargo e/ou Órgão.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-4-4": { desc: "0-2-4-4-4 - Afastamento para estudo ou missão no exterior.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-4-5": { desc: "0-2-4-4-5 - Afastamento para exercer mandato eletivo.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-4-6": { desc: "0-2-4-4-6 - Afastamento para servir ao Tribunal Regional Eleitoral (TRE).", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-4-7": { desc: "0-2-4-4-7 - Afastamento para servir como jurado.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-4-8": { desc: "0-2-4-4-8 - Afastamento para participação de programa de Pós-Graduação Stricto Sensu no Brasil.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-4-9": { desc: "0-2-4-4-9 - Afastamento por motivo de recesso.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-5-1": { desc: "0-2-4-5-1 - Reembolso de despesas (assuntos gerais). Refere-se aos documentos que não envolvem pagamento. // Incluem-se solicitações, requerimentos e consultas para pagamento de reembolso de despesas.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-2-4-5-2": { desc: "0-2-4-5-2 - Ressarcimento de cobranças indevidas.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-4-5-3": { desc: "0-2-4-5-3 - Locomoção. Incluem-se documentos referentes às despesas efetuadas com a utilização de meio próprio de locomoção para a execução de serviços externos.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-4-5-4": { desc: "0-2-4-5-4 - Mudança de domicílio (inclusive ajuda de custo).", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-4-5-5": { desc: "0-2-4-5-5 - Reembolso de despesa com educação.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-4-5-6": { desc: "0-2-4-5-6 - Ressarcimento de despesa com Plano de Saúde ou Seguro Saúde.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-4-5-7": { desc: "0-2-4-5-7 - Reembolso de despesa com a aquisição de livros jurídicos e códigos de legislação (Auxílio Livro).", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-4-6-1": { desc: "0-2-4-6-1 - Alistamento eleitoral.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-4-6-2": { desc: "0-2-4-6-2 - Casamento (gala).", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-6-3": { desc: "0-2-4-6-3 - Doação de sangue.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-6-4": { desc: "0-2-4-6-4 - Falecimento de familiar (nojo).", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-6-5": { desc: "0-2-4-6-5 - Horário especial para Defensor / Servidor estudante.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-6-6": { desc: "0-2-4-6-6 - Horário especial para Defensor / Servidor portador de deficiência.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-6-7": { desc: "0-2-4-6-7 - Afastamento do Estado. Inclui-se autorização para participação em evento, congresso simpósios, seminários e outros conclaves.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-6-8": { desc: "0-2-4-6-8 - Regime especial de jornada de trabalho.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-6-9": { desc: "0-2-4-6-9 - Teletrabalho.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: "52 anos", destinacao: "Eliminação" },
                "0-2-4-7-1": { desc: "0-2-4-7-1 - Auxílio Alimentação / Refeição.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-4-7-2": { desc: "0-2-4-7-2 - Auxílio Assistência Pré-escola / Creche.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-4-7-3": { desc: "0-2-4-7-3 - Auxílio-transporte.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-4-7-4": { desc: "0-2-4-7-4 - Auxílio Fardamento / Uniforme.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-4-7-5": { desc: "0-2-4-7-5 - Auxílio-Moradia.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-5-1-1": { desc: "0-2-5-1-1 - Procedimento Administrativo Disciplinar. Incluem-se documentos referentes à acumulação ilícita de cargo, emprego e função pública, afastamento preventivo, instauração de inquérito (ato de instituição da comissão de sindicância), inquérito administrativo (instrução, defesa, relatório e julgamento) e revisão do processo disciplinar.", prazoCorrente: "Até a conclusão da apuração", prazoIntermediario: 100, destinacao: "Guarda Permanente" },
                "0-2-5-1-2": { desc: "0-2-5-1-2 - Penalidade Disciplinar. Incluem-se documentos referentes à advertência, suspensão, exclusão, demissão, cassação de aposentadoria, disponibilidade, destituição de cargo em comissão e destituição de função comissionada.", prazoCorrente: "Até a conclusão da apuração", prazoIntermediario: 100, destinacao: "Guarda Permanente" },
                "0-2-6-1-1": { desc: "0-2-6-1-1 - Seguro Pessoal.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-6-1-2-1": { desc: "0-2-6-1-2-1 - Auxílio-Acidente.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-6-1-2-2": { desc: "0-2-6-1-2-2 - Auxílio-Doença.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-6-1-2-3": { desc: "0-2-6-1-2-3 - Auxílio-Funeral.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-6-1-2-4": { desc: "0-2-6-1-2-4 - Auxílio-Natalidade.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: "10 anos", destinacao: "Eliminação" },
                "0-2-6-1-3": { desc: "0-2-6-1-3 - Auxílio Reclusão.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-6-1-4-1": { desc: "0-2-6-1-4-1 - Pensão Provisória ou Temporária.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-6-1-4-2": { desc: "0-2-6-1-4-2 - Pensão Vitalícia.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-6-1-4-3": { desc: "0-2-6-1-4-3 - Pensão Especial.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-6-1-4-4": { desc: "0-2-6-1-4-4 - Pensão do Fundo de Reserva.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 100, destinacao: "Eliminação" },
                "0-2-6-1-5": { desc: "0-2-6-1-5 - Aposentadoria. Inclui-se o pedido e a revisão, bem como a pecúnia indenizatória. Inclui também o nada consta da biblioteca.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 35, destinacao: "Guarda Permanente" },
                "0-2-6-1-5-1": { desc: "0-2-6-1-5-1 - Solicitação de contagem e averbação de tempo de serviço para fins de aposentadoria.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-6-1-5-2": { desc: "0-2-6-1-5-2 - Contagem de tempo de serviço para fins de aposentadoria.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-6-1-5-3": { desc: "0-2-6-1-5-3 - Averbação / desaverbação de tempo de serviço para fins de aposentadoria.", prazoCorrente: "Até homologação da aposentadoria", prazoIntermediario: 35, destinacao: "Guarda Permanente" },
                "0-2-6-1-6": { desc: "0-2-6-1-6 - Assistência à Saúde. Inclui-se plano de saúde.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-6-1-6-1": { desc: "0-2-6-1-6-1 - Prontuário Médico do Defensor / Servidor.", prazoCorrente: "Enquanto houver vínculo", prazoIntermediario: 95, destinacao: "Eliminação" },
                "0-2-6-1-7": { desc: "0-2-6-1-7 - Aquisição de Imóvel por Defensor / Servidor.", prazoCorrente: "Até a quitação da dívida", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-6-1-8": { desc: "0-2-6-1-8 - Ocupação de Próprio da União ou do Estado.", prazoCorrente: "Até a desocupação", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-6-1-9": { desc: "0-2-6-1-9 - Transporte para Defensor / Servidor.", prazoCorrente: "Enquanto vigora", prazoIntermediario: "5 anos", destinacao: "Eliminação" },
                "0-2-6-2-1": { desc: "0-2-6-2-1 - Prevenção de acidentes de trabalho.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-6-2-1-1": { desc: "0-2-6-2-1-1 - Comissão Interna de Prevenção de Acidentes - CIPA. Inclui-se ato de criação, designação, propostas, relatórios e atas.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 8, destinacao: "Guarda Permanente" },
                "0-2-6-2-2": { desc: "0-2-6-2-2 - Fornecimento de refeição. Incluem-se documentos referentes à refeitório, cantina, copa e cardápios.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-2-6-2-3": { desc: "0-2-6-2-3 - Inspeção periódica de saúde.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-6-3": { desc: "0-2-6-3 - PREVIDÊNCIA PRIVADA Incluem-se documentos referentes aos planos privados de concessão de pecúlios ou de rendas, de benefícios complementares ou assemelhados aos da previdência social.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-2-7-1": { desc: "0-2-7-1 - MISSÃO FORA DA SEDE / VIAGEM A SERVIÇO NO BRASIL - SEM ÔNUS PARA A DPRJ", prazoCorrente: "Enquanto vigora", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-7-2": { desc: "0-2-7-2 - MISSÃO FORA DA SEDE / VIAGEM A SERVIÇO NO BRASIL - COM ÔNUS PARA A DPRJ Incluem-se documentos referentes à concessão de ajuda de custo, diária de deslocamento, diária de Plantão Judiciário, passagem (inclusive devolução), prestação de contas, relatórios de viagem, passaporte e reserva em hotel.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-7-3": { desc: "0-2-7-3 - MISSÃO FORA DA SEDE / VIAGEM A SERVIÇO NO EXTERIOR - SEM ÔNUS PARA A DPRJ", prazoCorrente: "Enquanto vigora", prazoIntermediario: 7, destinacao: "Eliminação" },
                "0-2-7-4": { desc: "0-2-7-4 - MISSÃO FORA DA SEDE / VIAGEM A SERVIÇO NO EXTERIOR - COM ÔNUS PARA A DPRJ Incluem-se documentos referentes à autorização de afastamento, lista de participantes (no caso de comitiva e delegações), concessão de diária (inclusive compra de moeda estrangeira), passagem (inclusive devolução), prestação de contas, relatório de viagem e reserva em hotel.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-8-0": { desc: "0-2-8-0 - DELEGAÇÃO DE COMPETÊNCIA / PROCURAÇÃO (ASSUNTOS GERAIS) Refere-se aos documentos que não envolvem pagamento.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-2-8-1": { desc: "0-2-8-1 - DELEGAÇÃO DE COMPETÊNCIA / PROCURAÇÃO - ORDENADOR DE DESPESAS Refere-se aos documentos que envolvem pagamentos.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-2-9": { desc: "0-2-9 - SERVIÇO PROFISSIONAL TRANSITÓRIO Inclui-se licitação. // Incluem-se autônomos e colaboradores quando desvinculados de empresas, bem como terceirizados com cessão de mão de obra (com retenção de INSS).", prazoCorrente: "Enquanto vigora a prestação do serviço", prazoIntermediario: 51, destinacao: "Eliminação" },
                "0-3-0-1": { desc: "0-3-0-1 - CADASTRO DE FORNECEDOR DE MATERIAL", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-3-0-2": { desc: "0-3-0-2 - ESPECIFICAÇÃO, PADRONIZAÇÃO, CODIFICAÇÃO, PREVISÃO, CATÁLOGO, IDENTIFICAÇÃO, CLASSIFICAÇÃO DE MATERIAL Inclui amostras.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-3-1-1-1": { desc: "0-3-1-1-1 - Compra ou aluguel de material permanente. Inclui-se compra por importação, bem como leasing e comodato.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-3-1-1-2": { desc: "0-3-1-1-2 - Aquisição de material permanente por empréstimo, cessão, doação ou permuta.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-3-1-1-3": { desc: "0-3-1-1-3 - Solicitação de material permanente não adquirido.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-3-1-2-1": { desc: "0-3-1-2-1 - Compra de material de consumo.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-3-1-2-2": { desc: "0-3-1-2-2 - Aquisição de material de consumo por cessão, doação ou permuta.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-3-1-2-3": { desc: "0-3-1-2-3 - Solicitação de material de consumo não adquirido.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-3-2-0-1": { desc: "0-3-2-0-1 - CONTROLE DE ESTOQUE. Termo de Responsabilidade. Inclui-se Relatório de Movimentação de Bens (RMB) ou Relatório de Movimentação de Bens Móveis (RBM) e as Guias de Movimentação de Bens.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-3-2-1": { desc: "0-3-2-1 - CONTROLE DE ESTOQUE Inclui-se requisição, distribuição e Relatório de Movimentação de Almoxarifado (RMA).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-3-2-2": { desc: "0-3-2-2 - EXTRAVIO, ROUBO OU DESAPARECIMENTO DE MATERIAL Inclui-se comunicação de ocorrência.", prazoCorrente: "Até a conclusão do caso", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-3-2-3": { desc: "0-3-2-3 - TRANSPORTE DE MATERIAL", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-3-2-4": { desc: "0-3-2-4 - AUTORIZAÇÃO DE SAÍDA DE MATERIAL", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-3-2-5": { desc: "0-3-2-5 - RECOLHIMENTO DE MATERIAL AO DEPÓSITO", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-3-3-1": { desc: "0-3-3-1 - TRANSFERÊNCIA DE MATERIAL", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-3-3-2": { desc: "0-3-3-2 - VENDA DE MATERIAL Inclui-se leilão.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-3-3-3": { desc: "0-3-3-3 - ALIENAÇÃO DE MATERIAL POR RENÚNCIA, CESSÃO, DOAÇÃO OU PERMUTA", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-3-3-4": { desc: "0-3-3-4 - DESCARTE E INUTILIZAÇÃO DE MATERIAL", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-3-3-5": { desc: "0-3-3-5 - BAIXA PATRIMONIAL DE MATERIAL", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-3-4-1": { desc: "0-3-4-1 - ORDEM DE SERVIÇO PARA INSTALAÇÃO E MANUTENÇÃO DE EQUIPAMENTO E MOBILIÁRIO", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-3-4-2": { desc: "0-3-4-2 - SERVIÇO DE INSTALAÇÃO E MANUTENÇÃO DE EQUIPAMENTO E MOBILIÁRIO EXECUTADO EM OFICINA DA DPRJ", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-3-5-1": { desc: "0-3-5-1 - INVENTÁRIO DE MATERIAL PERMANENTE Quando se tratar de fechamento contábil de material permanente, classificar no código 0-5-8-1.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-3-5-2": { desc: "0-3-5-2 - INVENTÁRIO DE MATERIAL DE CONSUMO Quando se tratar de fechamento contábil de material de consumo, classificar no código 0-5-8-2.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-1": { desc: "0-4-1 - BEM IMÓVEL Incluem-se escrituras, plantas e projetos relativos aos edifícios, terrenos, residências e salas.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Guarda Permanente" },
                "0-4-1-0-1": { desc: "0-4-1-0-1 - Fornecimento, instalação, manutenção e reparo de serviços básicos (assuntos gerais). Refere-se aos documentos que não envolvem pagamentos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-1-0-1-1": { desc: "0-4-1-0-1-1 - Ordem de serviço para fornecimento, instalação, manutenção e reparo de serviços básicos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-4-1-0-2-1": { desc: "0-4-1-0-2-1 - Água e esgoto, gás ou energia elétrica.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-1-0-2-2": { desc: "0-4-1-0-2-2 - Transmissão de dados, voz e imagem. Inclui-se telefone, Internet, videoconferência e prestação de contas de telefonia celular e internet móvel.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-1-0-3-1": { desc: "0-4-1-0-3-1 - Condomínio (assuntos gerais). Refere-se aos documentos que não envolvem pagamentos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-1-0-3-2": { desc: "0-4-1-0-3-2 - Condomínio. Refere-se aos documentos que envolvem pagamentos.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-1-1-1": { desc: "0-4-1-1-1 - Compra de imóvel.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-4-1-1-2": { desc: "0-4-1-1-2 - Aquisição de imóvel por cessão, doação ou permuta.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-4-1-1-3": { desc: "0-4-1-1-3 - Aquisição de imóvel por locação, arrendamento ou comodato. Inclui-se locação de estacionamento e de garagem.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-1-1-4": { desc: "0-4-1-1-4 - Solicitação de imóvel não adquirido.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-1-2-1": { desc: "0-4-1-2-1 - Venda de imóvel.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-4-1-2-2": { desc: "0-4-1-2-2 - Alienação de imóvel por cessão, doação ou permuta.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-4-1-3": { desc: "0-4-1-3 - DESAPROPRIAÇÃO. REINTEGRAÇÃO DE POSSE. REIVINDICAÇÃO DE DOMÍNIO. TOMBAMENTO.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-4-1-4-1": { desc: "0-4-1-4-1 - Reforma. Recuperação. Restauração. Construção.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-4-1-5-1": { desc: "0-4-1-5-1 - Ordem de serviço para limpeza, imunização e desinfestação. Inclusive para jardins.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-4-1-5-2": { desc: "0-4-1-5-2 - Ordem de serviço para manutenção de infraestrutura predial. Incluem-se instalações elétricas, hidrossanitárias, águas pluviais, subestações, gás liquefeito de Petróleo (G.L.P.).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-4-1-5-3": { desc: "0-4-1-5-3 - Ordem de serviço para manutenção de sistemas eletromecânicos. Incluem-se supervisão predial, sistemas de telefonia, elevadores, climatização (ar condicionado, desumidificador ou aquecedor), exaustão e aparelhos eletro-eletrônicos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-4-1-6": { desc: "0-4-1-6 - CONCESSÃO DE USO DE BENS IMÓVEIS Incluem-se documentos referentes à concessão temporária de longo prazo de uso de bens imóveis por entidade pública, entidade privada, bem como por associações, federações, conselhos e entidades de classe.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-1-7": { desc: "0-4-1-7 - USO DE DEPENDÊNCIAS Incluem-se documentos referentes à utilização por curto prazo de auditórios e demais dependências dos imóveis, pela DPRJ ou por terceiros.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-1-8-1": { desc: "0-4-1-8-1 - Mudança para outro imóvel ou dentro do mesmo imóvel (assuntos gerais). Refere-se aos documentos que não envolvem pagamento.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-1-8-2": { desc: "0-4-1-8-2 - Mudança para outro imóvel ou dentro do mesmo imóvel. Refere-se aos documentos que envolvem pagamento.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-2-1-1": { desc: "0-4-2-1-1 - Compra ou aluguel de veículo. Inclui-se compra por importação.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-2-1-2": { desc: "0-4-2-1-2 - Aquisição de veículo por cessão, doação, permuta ou transferência.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-2-1-3": { desc: "0-4-2-1-3 - Solicitação de veículo não adquirido.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-2-2": { desc: "0-4-2-2 - CADASTRO, LICENCIAMENTO, EMPLACAMENTO E TOMBAMENTO DE VEÍCULO", prazoCorrente: "Até a alienação do veículo", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-4-2-3-1": { desc: "0-4-2-3-1 - Venda de veículo. Inclui-se leilão.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-2-3-2": { desc: "0-4-2-3-2 - Alienação de veículo por cessão, doação, permuta ou transferência.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-2-4": { desc: "0-4-2-4 - ABASTECIMENTO, LIMPEZA, MANUTENÇÃO E REPARO DE VEÍCULO", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-2-5": { desc: "0-4-2-5 - ACIDENTE DE VEÍCULO SEM VÍTIMAS, INFRAÇÃO E MULTA DE VEÍCULO", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-2-6": { desc: "0-4-2-6 - ACIDENTE DE VEÍCULO COM VÍTIMA", prazoCorrente: "Até a conclusão da apuração", prazoIntermediario: 20, destinacao: "Eliminação" },
                "0-4-2-7-1": { desc: "0-4-2-7-1 - Requisição de uso de veículo.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-2-7-2": { desc: "0-4-2-7-2 - Autorização para uso de veículo fora do horário de expediente.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-2-7-3": { desc: "0-4-2-7-3 - Requisição de uso de estacionamento e garagem.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-3-1": { desc: "0-4-3-1 - INVENTÁRIO DE BENS IMÓVEIS E VEÍCULOS Inclui-se Relatório de Movimentação de Bens (RMB). // Quanto ao fechamento contábil patrimonial, classificar no código 0-5-8-3.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-4-4-1": { desc: "0-4-4-1 - SERVIÇO DE VIGILÂNCIA (ASSUNTOS GERAIS) Refere-se aos documentos que não envolvem pagamento.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-4-2": { desc: "0-4-4-2 - SERVIÇO DE VIGILÂNCIA Refere-se aos documentos que envolvem pagamento.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-4-3": { desc: "0-4-4-3 - SEGURO (ASSUNTOS GERAIS) Inclui-se veículo. // Refere-se aos documentos que não envolvem pagamento.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-4-4-4": { desc: "0-4-4-4 - SEGURO Inclui-se veículo. // Refere-se aos documentos que envolvem pagamento.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-4-4-5": { desc: "0-4-4-5 - PREVENÇÃO DE INCÊNDIO Inclui-se licitação. // Incluem-se documentos referentes ao treinamento de pessoal, ordens de serviço para instalação e manutenção de extintores e inspeção periódica.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-4-4-5-1": { desc: "0-4-4-5-1 - Brigada de incêndio. Incluem-se documentos referentes à constituição de brigadas de incêndio, bem como planos, projetos e relatórios.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 4, destinacao: "Guarda Permanente" },
                "0-4-4-6": { desc: "0-4-4-6 - SINISTRO Incluem-se documentos referentes às vistorias, sindicâncias e perícias técnicas relativas a arrombamento, desaparecimento, roubo, extravio de bens da DPRJ ou de bens de particulares e incêndio.", prazoCorrente: "Até a conclusão do caso", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-4-4-7": { desc: "0-4-4-7 - CONTROLE DE PORTARIA Incluem-se documentos referentes ao controle de entrada e saída de pessoas, materiais e veículos; permissão para entrada e permanência fora do horário de expediente; controle de entrega e devolução de chave.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 15, destinacao: "Eliminação" },
                "0-4-4-7-1": { desc: "0-4-4-7-1 - Registro de ocorrências. Refere-se a controle de portaria (entrada e saída).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-0-1": { desc: "0-5-0-1 - AUDITORIA", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-5-0-2": { desc: "0-5-0-2 - TRIBUTO (IMPOSTO E TAXA) Inclui-se isenção.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-1-1-1": { desc: "0-5-1-1-1 - Previsão Orçamentária. Incluem-se documentos referentes à proposta, elaboração e revisão de Plano Plurianual de Investimentos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-5-1-1-2": { desc: "0-5-1-1-2 - Proposta Orçamentária.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-5-1-1-3": { desc: "0-5-1-1-3 - Quadro de Detalhamento de Despesa - QDD. Incluem-se documentos referentes às metas e destinações de recursos e receitas por fonte.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-5-1-1-4": { desc: "0-5-1-1-4 - Crédito Adicional. Incluem-se documentos referentes aos créditos suplementar, especial e extraordinário, e modificação orçamentária.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-5-1-2-0": { desc: "0-5-1-2-0 - Nota de empenho. Liquidação de despesa. Nota de autorização de Despesa (NAD).", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-1-2-1": { desc: "0-5-1-2-1 - Descentralização de recurso (distribuição orçamentária). Incluem-se documentos referentes às transferências, provisão, destaques, estornos e subvenções, bem como a Nota de Movimentação de Crédito.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-1-2-2": { desc: "0-5-1-2-2 - Acompanhamento de despesa mensal (pessoal / dívida).", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-1-2-3": { desc: "0-5-1-2-3 - Plano operativo. Cronograma de desembolso. Contingenciamento. Descontingenciamento.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-2-1": { desc: "0-5-2-1 - PROGRAMAÇÃO FINANCEIRA DE DESEMBOLSO", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-2-2-1": { desc: "0-5-2-2-1 - Receita. Incluem-se documentos referentes aos créditos do Tesouro Nacional (cota, repasse e sub-repasse), taxas cobradas por serviços, multas, emolumentos e outras rendas arrecadadas.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-2-2-2-1": { desc: "0-5-2-2-2-1 - Pagamento de aquisição de bens / pagamento da contratação de serviços de natureza continuada e não continuada. Quanto aos documentos e processos que tratem de obras e possuem estudos, plantas e alterações de estrutura, ver o código 0-4-1.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-2-2-2-2": { desc: "0-5-2-2-2-2 - Concessão de Adiantamento de Despesa. Refere-se a despesas miúdas de pronto pagamento; despesas eventuais de Gabinete e despesas extraordinárias ou urgentes. // Quando se tratar de prestação de contas de adiantamento, classificar no código 0-5-7-2.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-2-2-2-3": { desc: "0-5-2-2-2-3 - Suprimento de fundos.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-2-2-2-4": { desc: "0-5-2-2-2-4 - Reconhecimento de dívida. Refere-se a despesas que não tenham sido empenhadas em época própria; restos a pagar com prescrição interrompida; bem como compromisso reconhecido após encerramento de exercício.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-2-2-2-5": { desc: "0-5-2-2-2-5 - Ressarcimento de despesas.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-3": { desc: "0-5-3 - FUNDO ESPECIAL", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-3-1-1": { desc: "0-5-3-1-1 - Honorário (assuntos gerais). Refere-se aos documentos que não envolvem pagamento.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-5-3-1-2": { desc: "0-5-3-1-2 - Honorário. Refere-se aos documentos que envolvem pagamento. // Incluem-se documentos referentes a execução, parcelamento, estorno, adjudicação de bens e precatória criminal.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-4": { desc: "0-5-4 - ESTÍMULO FINANCEIRO E CREDITÍCIO Incluem-se documentos referentes aos subsídios, incentivos fiscais e investimentos.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-5-5-1": { desc: "0-5-5-1 - PAGAMENTOS EM MOEDA ESTRANGEIRA", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-5-2": { desc: "0-5-5-2 - CONTA ÚNICA Incluem-se assinaturas autorizadas e extratos de contas.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-5-3": { desc: "0-5-5-3 - OUTRAS CONTAS: TIPO B, TIPO C E TIPO D Incluem-se assinaturas autorizadas e extratos de contas.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-6": { desc: "0-5-6 - BALANÇOS. BALANCETES", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-5-7-1": { desc: "0-5-7-1 - TOMADA DE CONTAS Inclusive Tomada de Contas Especial. // Incluem-se parecer de aprovação das contas, documentos referentes à avaliação da gestão dos responsáveis.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-5-7-2": { desc: "0-5-7-2 - PRESTAÇÃO DE CONTAS Inclui-se prestação de contas de adiantamento. // Quanto à prestação de contas de despesas relativas a gastos com diárias e passagens, fornecimento e manutenção de serviços, classificar no assunto específico.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-5-8-1": { desc: "0-5-8-1 - FECHAMENTO CONTÁBIL DE MATERIAL PERMANENTE Quanto ao inventário de material permanente, classificar no código 0-3-5-1.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-8-2": { desc: "0-5-8-2 - FECHAMENTO CONTÁBIL DE MATERIAL DE CONSUMO Quanto ao inventário de material de consumo, classificar no código 0-3-5-2.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-5-8-3": { desc: "0-5-8-3 - FECHAMENTO CONTÁBIL PATRIMONIAL Quanto ao inventário de bem imóvel e veículo, classificar no código 0-4-3-1.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-6-0-1-1-1": { desc: "0-6-0-1-1-1 - Publicação de matérias (assuntos gerais). Refere-se aos documentos que não envolvem pagamentos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-0-1-1-2": { desc: "0-6-0-1-1-2 - Publicação de matérias em veículos oficiais. Incluem-se diário, jornal e periódico oficiais, bem como sistemas corporativos. // Quando se tratar de publicação de matérias no Diário Oficial Eletrônico da DPRJ, classificar no código 0-1-2-1-4.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-6-0-1-1-3": { desc: "0-6-0-1-1-3 - Publicação de matérias nos boletins administrativos, de pessoal e de serviço.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-0-1-1-4": { desc: "0-6-0-1-1-4 - Publicação de matérias em outros periódicos.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-6-0-1-2-1": { desc: "0-6-0-1-2-1 - Publicação de Obra Institucional (assuntos gerais). Refere-se aos documentos que não envolvem pagamentos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-0-1-2-2": { desc: "0-6-0-1-2-2 - Publicação de Obra Institucional. Refere-se aos documentos que envolvem pagamentos.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-6-0-2-1": { desc: "0-6-0-2-1 - Produção editorial (assuntos gerais). Refere-se aos documentos que não envolvem pagamentos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-0-2-2": { desc: "0-6-0-2-2 - Editoração. Programação visual. Incluem-se documentos referentes à composição, copidesque e revisão de textos", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-6-0-2-3": { desc: "0-6-0-2-3 - Distribuição. Promoção. Divulgação de Produção Editorial. Incluem-se documentos referentes à doação, permuta e venda.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-6-0-3": { desc: "0-6-0-3 - PRODUÇÃO GRÁFICA Incluem-se documentos referentes à confecção de formulário, cartilha, folder, folheto, convite, cartaz, cartão e outros; em suas versões impressas e digitais.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-6-0-4": { desc: "0-6-0-4 - PRODUÇÃO DE ARTE E IDENTIDADE VISUAL Incluem-se documentos referentes à design gráfico eletrônico.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-1-0": { desc: "0-6-1-0 - NORMA. MANUAL Incluem-se estudos e orientações referentes à elaboração de metodologias e procedimentos técnicos adotados para o tratamento da documentação bibliográfica.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-1-1-1": { desc: "0-6-1-1-1 - Compra de documentação bibliográfica. Inclui-se assinatura de periódico.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-6-1-1-2": { desc: "0-6-1-1-2 - Aquisição de documentação bibliográfica por doação.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-6-1-1-3": { desc: "0-6-1-1-3 - Aquisição de documentação bibliográfica por permuta.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-6-1-1-4": { desc: "0-6-1-1-4 - Solicitação de material bibliográfico não adquirido.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-1-2-1": { desc: "0-6-1-2-1 - Registro de documentação bibliográfica (assuntos gerais).", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-1-2-2": { desc: "0-6-1-2-2 - Livro tombo. Refere-se à documentação bibliográfica.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 0, destinacao: "Guarda Permanente" },
                "0-6-1-3": { desc: "0-6-1-3 - CATALOGAÇÃO, CLASSIFICAÇÃO E INDEXAÇÃO DE DOCUMENTAÇÃO BIBLIOGRÁFICA", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-1-4": { desc: "0-6-1-4 - REFERÊNCIA E CIRCULAÇÃO DE DOCUMENTAÇÃO BIBLIOGRÁFICA Incluem-se documentos referentes às consultas, pesquisas bibliográficas, bibliografias, empréstimos e intercâmbio entre bibliotecas.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-1-5": { desc: "0-6-1-5 - INVENTÁRIO DE DOCUMENTAÇÃO BIBLIOGRÁFICA Quanto aos inventários de material permanente e de consumo, classificar nos códigos 0-3-5-1 e 0-3-5-2; inventário de bem imóvel e veículo, classificar nos códigos 0-4-3-1; inventário de documentos e processos, classificar no código 0-6-2-6.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-6-2-0": { desc: "0-6-2-0 - NORMAS. MANUAIS Incluem-se estudos e orientações referentes à elaboração de documentos, metodologias e procedimentos técnicos para tratamento da documentação arquivística. Pesquisa sobre proveniência. Código de Classificação de Documentos. Tabela de Temporalidade.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-2-1": { desc: "0-6-2-1 - PRODUÇÃO DE DOCUMENTOS. LEVANTAMENTO E FLUXO DE PRODUÇÃO DOCUMENTAL", prazoCorrente: "Enquanto vigora", prazoIntermediario: 4, destinacao: "Eliminação" },
                "0-6-2-1-1": { desc: "0-6-2-1-1 - Diagnóstico de Gestão Documental. Relatório. Plano. Projeto.", prazoCorrente: "Enquanto estiver em fase de implantação", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-2-2": { desc: "0-6-2-2 - PROTOCOLO Refere-se à recepção, tramitação e expedição de documentos arquivísticos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 4, destinacao: "Eliminação" },
                "0-6-2-2-1": { desc: "0-6-2-2-1 - Serviço postal. Incluem-se serviço de coleta, transporte e entrega de correspondência (SEDEX, SEM, Malote, Mala oficial).", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-6-2-2-2": { desc: "0-6-2-2-2 - Registro e autuação de processos. Incluem-se Livro Tombo (autuação de processo) e ata de distribuição.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-2-2-3": { desc: "0-6-2-2-3 - Registro do andamento processual.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-2-2-4": { desc: "0-6-2-2-4 - Requisição e controle de serviço reprográfico. Inclusive assinaturas autorizadas e reprodução e formulários.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-2-3": { desc: "0-6-2-3 - ASSESSORAMENTO TÉCNICO À GESTÃO DE DOCUMENTOS E SISTEMA DE ARQUIVO", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-6-2-4": { desc: "0-6-2-4 - CLASSIFICAÇÃO E ARQUIVAMENTO DE DOCUMENTOS (ASSUNTOS GERAIS)", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-2-5-1": { desc: "0-6-2-5-1 - Análise, avaliação e seleção documental.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-2-5-2": { desc: "0-6-2-5-2 - Eliminação de documentos (termo, listagem e edital de ciência de eliminação). Incluem-se termo, listagem e edital de ciência de eliminação.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-2-5-3": { desc: "0-6-2-5-3 - Transferência e recolhimento de documentos. Incluem-se guia e termo de transferência; guia, relação e termo de recolhimento; e listagem descritiva do acervo.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-2-6": { desc: "0-6-2-6 - INVENTÁRIO DE DOCUMENTOS E PROCESSOS Quanto aos inventários de material permanente e de consumo, classificar nos códigos 0-3-5-1 e 0-3-5-2; inventário de bem imóvel e veículo, classificar nos códigos 0-4-3-1; inventário de documentação bibliográfica, classificar no código 0-6-1-5.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-3-0": { desc: "0-6-3-0 - NORMA. MANUAL Incluem-se estudos e orientações referentes à elaboração de documentos, metodologias e procedimentos técnicos para tratamento de documentação e peças museológicas.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-3-1": { desc: "0-6-3-1 - PROGRAMA DE HISTÓRIA ORAL (ENTREVISTAS. DEPOIMENTOS. TRANSCRIÇÕES)", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-6-3-2": { desc: "0-6-3-2 - MEMÓRIA INSTITUCIONAL", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-6-4-0": { desc: "0-6-4-0 - NORMA. MANUAL Incluem-se documentos referentes a projetos, estudos e normas sobre política de acesso à informação em qualquer suporte.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-4-0-1": { desc: "0-6-4-0-1 - Informações sobre a DPRJ. Incluem-se documentos referentes aos pedidos de informações sobre as funções e atividades da DPRJ e os serviços que presta.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" },
                "0-6-4-0-2": { desc: "0-6-4-0-2 - Solicitação de consulta, empréstimo e cópia de processos e documentos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-6-5-0": { desc: "0-6-5-0 - NORMA. MANUAL Incluem-se documentos referentes a projetos, estudos, normas e solicitações sobre transferência, para qualquer suporte (inclusive digitalização e microfilmagem), de documentação arquivística, bibliográfica e museológica.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-6-6-1-1": { desc: "0-6-6-1-1 - Desinfestação, higienização (assuntos gerais). Refere-se aos documentos que não envolvem pagamentos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-6-1-2": { desc: "0-6-6-1-2 - Desinfestação, higienização. Refere-se aos documentos que envolvem pagamentos.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-6-6-2": { desc: "0-6-6-2 - ARMAZENAMENTO DE DOCUMENTOS Inclusive depósito e centro de informação.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-6-3-1": { desc: "0-6-6-3-1 - Restauração de documentos (assuntos gerais). Refere-se aos documentos que não envolvem pagamentos. // Inclui-se encadernação.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-6-6-3-2": { desc: "0-6-6-3-2 - Restauração de documentos. Refere-se aos documentos que envolvem pagamentos. // Inclui-se encadernação.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-7-1": { desc: "0-7-1 - PLANO E PROJETO DE INFORMÁTICA Inclui-se plano de contingência.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-7-2": { desc: "0-7-2 - PROGRAMA, SISTEMA E REDE DE INFORMÁTICA Incluem-se licença e registro de uso e compra.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-7-2-1": { desc: "0-7-2-1 - MANUAL TÉCNICO DE INFORMÁTICA Refere-se a exemplares únicos.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-7-2-2": { desc: "0-7-2-2 - MANUAL DO USUÁRIO Refere-se a exemplares únicos de procedimentos para utilização de programas e sistemas.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-7-2-3": { desc: "0-7-2-3 - AQUISIÇÃO DE SOLUÇÕES DE TECNOLOGIA DA INFORMAÇÃO Incluem-se software e certificados digitais. // Quando se tratar de aquisição de equipamento ver o código 0-3-1-1.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Guarda Permanente" },
                "0-7-2-4": { desc: "0-7-2-4 - SISTEMAS CORPORATIVOS DESENVOLVIDOS OU CUSTOMIZADOS PELA DPRJ Incluem-se screenshots e código-fonte.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Guarda Permanente" },
                "0-7-3-1": { desc: "0-7-3-1 - ASSISTÊNCIA TÉCNICA DE INFORMÁTICA (ASSUNTOS GERAIS) Refere-se aos documentos que não envolvem pagamento.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 2, destinacao: "Eliminação" },
                "0-7-3-1-1": { desc: "0-7-3-1-1 - Ordem de serviço de assistência técnica de informática Incluem-se solicitações de atendimento e apoio ao usuário, relatórios de chamadas pendentes e relatórios de chamadas atendidas.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 3, destinacao: "Eliminação" },
                "0-7-3-2": { desc: "0-7-3-2 - ASSISTÊNCIA TÉCNICA DE INFORMÁTICA. Refere-se aos documentos que envolvem pagamento.", prazoCorrente: "Até a aprovação das contas", prazoIntermediario: 10, destinacao: "Eliminação" },
                "0-7-4-1": { desc: "0-7-4-1 - INCIDENTE DE SEGURANÇA DA INFORMAÇÃO", prazoCorrente: "Até a conclusão da apuração", prazoIntermediario: 52, destinacao: "Eliminação" },
                "0-8-0": { desc: "0-8-0 - ASSOCIAÇÕES CULTURAIS, DE AMIGOS E DE DEFENSORES / SERVIDORES Incluem-se documentos referente à organização e estrutura.", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Guarda Permanente" },
                "0-8-0-1": { desc: "0-8-0-1 - COMUNICADOS E INFORMES SOBRE ASSOCIAÇÕES CULTURAIS, DE AMIGOS E DE DEFENSORES / SERVIDORES", prazoCorrente: "Enquanto vigora", prazoIntermediario: 5, destinacao: "Eliminação" }
            }
        };
        // ======================================================

        // NOVO: Possíveis valores para o filtro de Situação
        const situacaoValores = [
            "DOCUMENTO DE GUARDA PERMANENTE",
            "MANTER EM GUARDA ATÉ O PRAZO FINAL",
            "ENCAMINHAR PARA ELIMINAÇÃO",
            "Aguardando Data de Abertura",
            "AGUARDANDO O ANO DO FIM DA VIGÊNCIA",
            "Ano Fim Vigência anterior à Data Abertura"
        ];


        document.addEventListener('DOMContentLoaded', () => {
            // ... código existente ...
            const recDeleteSelectedBtn = document.getElementById('rec-delete-selected-btn');
            const recSelectAllCheck = document.getElementById('rec-select-all-check');

            const recClassifySelectedBtn = document.getElementById('rec-classify-selected-btn');
            const batchClassifyModal = document.getElementById('batch-classify-modal');
            const batchClassifyCount = document.getElementById('batch-classify-count');
            const batchClassifyForm = document.getElementById('batch-classify-form');
            const batchRecTipoAtividadeSelect = document.getElementById('batch-rec-tipo-atividade');
            const batchRecClassificacaoSelect = document.getElementById('batch-rec-classificacao');
            const batchRecDestinacaoInput = document.getElementById('batch-rec-destinacao-final');
            const batchRecTagsInput = document.getElementById('batch-rec-tags-to-add');
            const batchClassifyStatus = document.getElementById('batch-classify-status');
            const batchClassifySaveBtn = document.getElementById('batch-classify-save-btn');
            // ... código existente ...

            // --- Estado Global ---
            // REMOVIDO: allRecords, processSteps, colorRules, currentEditingSteps, selectedStepIndex
            let currentUser = null, userProfile = null, allRecuperacaoDocs = [], allMessages = {}, messageListener = null, managedTags = {}, allUsers = {};
            let recCurrentPage = 1;
            const recRecordsPerPage = 20;

            // --- Referências DOM (Simplificado) ---
            // REMOVIDO: Variáveis relacionadas à Gestão (abas, tabelas, modais, botões)
            const loginContainer = document.getElementById('login-container'), mainAppContainer = document.getElementById('main-app'), loginEmailInput = document.getElementById('login-email'), loginPasswordInput = document.getElementById('login-password'), loginRememberCheck = document.getElementById('login-remember'), loginBtn = document.getElementById('login-btn'), registerOpenBtn = document.getElementById('register-open-btn'), loginStatus = document.getElementById('login-status'), logoutBtn = document.getElementById('logout-btn'), userInfo = document.getElementById('user-info'), tabNavigation = document.getElementById('tab-navigation'), tabContent = document.getElementById('tab-content'), recTableBody = document.getElementById('rec-table-body'), recSearchInput = document.getElementById('rec-search-input'), recSearchBtn = document.getElementById('rec-search-btn'), openRecuperacaoFormBtn = document.getElementById('open-recuperacao-form-btn'), importRecBtn = document.getElementById('import-rec-btn'), importRecInput = document.getElementById('import-rec-input'), recPrevBtn = document.getElementById('rec-prev-btn'), recNextBtn = document.getElementById('rec-next-btn'), recPageNum = document.getElementById('rec-page-num'), recTotalPages = document.getElementById('rec-total-pages'), registerModal = document.getElementById('register-modal'), registerNameInput = document.getElementById('register-name'), registerEmailInput = document.getElementById('register-email'), registerPasswordInput = document.getElementById('register-password'), registerConfirmPasswordInput = document.getElementById('register-confirm-password'), registerSubmitBtn = document.getElementById('register-submit-btn'), registerStatus = document.getElementById('register-status'), recuperacaoFormModal = document.getElementById('recuperacao-form-modal'), recuperacaoSaveBtn = document.getElementById('recuperacao-save-btn'), recuperacaoForm = document.getElementById('recuperacao-form'), recuperacaoStatus = document.getElementById('recuperacao-status'), recDestinacaoSelect = document.getElementById('rec-destinacao-final'), recDataEliminacaoGroup = document.getElementById('rec-data-eliminacao-group'), recDocIdInput = document.getElementById('rec-doc-id'), recuperacaoDeleteBtn = document.getElementById('recuperacao-delete-btn'), adminBtn = document.getElementById('admin-btn'), adminModal = document.getElementById('admin-modal'), adminGestaoTagsBtn = document.getElementById('admin-gestao-tags-btn'), adminEnviarMsgBtn = document.getElementById('admin-enviar-msg-btn'), adminGestaoUsersBtn = document.getElementById('admin-gestao-users-btn'), messagesBtn = document.getElementById('messages-btn'), messageBadge = document.getElementById('message-badge'), viewMessagesModal = document.getElementById('view-messages-modal'), viewMessagesTableBody = document.getElementById('view-messages-table-body'), messageContentDiv = document.getElementById('message-content-view'), sendMessageModal = document.getElementById('send-message-modal'), sendMessageRecipient = document.getElementById('send-message-recipient'), sendMessageContent = document.getElementById('send-message-content'), sendMessageBtn = document.getElementById('send-message-btn'), sendMessageStatus = document.getElementById('send-message-status'), tagManagementModal = document.getElementById('tag-management-modal'), tagManagementTableBody = document.getElementById('tag-management-table-body'), addNewTagBtn = document.getElementById('add-new-tag-btn'), tagEditModal = document.getElementById('tag-edit-modal'), tagEditModalTitle = document.getElementById('tag-edit-modal-title'), tagEditForm = document.getElementById('tag-edit-form'), tagEditIdInput = document.getElementById('tag-edit-id'), tagEditNameInput = document.getElementById('tag-edit-name'), tagEditStatus = document.getElementById('tag-edit-status'), saveTagBtn = document.getElementById('save-tag-btn'), userManagementModal = document.getElementById('user-management-modal'), userManagementTableBody = document.getElementById('user-management-table-body'), refreshUsersBtn = document.getElementById('refresh-users-btn');
            const globalToast = document.getElementById('global-toast');
            let toastTimeout;
            const confirmModal = document.getElementById('confirm-modal');
            const confirmModalTitle = document.getElementById('confirm-modal-title');
            const confirmModalMessage = document.getElementById('confirm-modal-message');
            const confirmModalOkBtn = document.getElementById('confirm-modal-ok-btn');
            const confirmModalCancelBtn = document.getElementById('confirm-modal-cancel-btn');
            const recRefreshBtn = document.getElementById('rec-refresh-btn');
            const recTipoAtividadeSelect = document.getElementById('rec-tipo-atividade');
            const recClassificacaoSelect = document.getElementById('rec-classificacao');
            // NOVAS Referências DOM da TTD
            const recAnoVigenciaGroup = document.getElementById('rec-ano-vigencia-group');
            const recSituacaoInput = document.getElementById('rec-situacao');
            const recDataAberturaInput = document.getElementById('rec-data-abertura');
            const recAnoVigenciaInput = document.getElementById('rec-ano-vigencia');

            // NOVO: Referências DOM de Filtros e Total
            const recTotalRecordsSpan = document.getElementById('rec-total-records');
            const openFilterBtn = document.getElementById('open-filter-btn');
            const recClearFiltersBtn = document.getElementById('rec-clear-filters-btn');
            const filterModal = document.getElementById('filter-modal');
            const applyFiltersBtn = document.getElementById('apply-filters-btn');
            const filterForm = document.getElementById('filter-form');
            const filterUnidadeSelect = document.getElementById('filter-unidade');
            const filterClassificacaoSelect = document.getElementById('filter-classificacao');
            const filterDestinacaoSelect = document.getElementById('filter-destinacao');
            const filterTagsInput = document.getElementById('filter-tags');
            const filterAnoAberturaInput = document.getElementById('filter-ano-abertura');
            const filterDataStartInput = document.getElementById('filter-data-abertura-start');
            const filterDataEndInput = document.getElementById('filter-data-abertura-end');
            // NOVO: Mais filtros
            const filterAtividadeSelect = document.getElementById('filter-atividade');
            const filterSituacaoSelect = document.getElementById('filter-situacao');
            const filterInteressadoInput = document.getElementById('filter-interessado');
            // ======================================================
            // ==== NOVAS REFERÊNCIAS (SELEÇÃO MÚLTIPLA) ====
            // ======================================================
            const recDeleteSelectedBtn = document.getElementById('rec-delete-selected-btn');
            const recSelectAllCheck = document.getElementById('rec-select-all-check');
            // =====================================================
            
            // NOVO: Referências DOM do Interessado (Múltiplo)
            const recInteressadoInput = document.getElementById('rec-interessado-input');
            const recInteressadoAddBtn = document.getElementById('rec-interessado-add-btn');
            const recInteressadoList = document.getElementById('rec-interessado-list');


            // ======================================================
            // ==== FUNÇÕES: showToast e showConfirm ====
            // ======================================================
            
            function showToast(message, type = 'error') {
                if (toastTimeout) clearTimeout(toastTimeout);
                globalToast.textContent = message;
                globalToast.className = `status-${type}`;
                globalToast.classList.remove('hidden');
                globalToast.classList.add('show');
                
                toastTimeout = setTimeout(() => {
                    globalToast.classList.remove('show');
                    globalToast.classList.add('hidden');
                }, 3500);
            }

            function showConfirm(title, message) {
                confirmModalTitle.textContent = title;
                confirmModalMessage.innerHTML = message.replace(/\n/g, '<br>');
                confirmModal.style.display = 'flex';
                
                return new Promise((resolve) => {
                    const onOk = () => {
                        confirmModal.style.display = 'none';
                        cleanup();
                        resolve(true);
                    };
                    
                    const onCancel = () => {
                        confirmModal.style.display = 'none';
                        cleanup();
                        resolve(false);
                    };

                    const cleanup = () => {
                        confirmModalOkBtn.removeEventListener('click', onOk);
                        confirmModalCancelBtn.removeEventListener('click', onCancel);
                    };

                    confirmModalOkBtn.addEventListener('click', onOk);
                    confirmModalCancelBtn.addEventListener('click', onCancel);
                });
            }


            // ======================================================
            // ==== LÓGICA DE AUTENTICAÇÃO (CORRIGIDA PARA O F5) ====
            // ======================================================
            loginBtn.addEventListener('click', async () => { 
                const email = loginEmailInput.value; 
                const password = loginPasswordInput.value; 
                const remember = loginRememberCheck.checked; 
                if (!email || !password) { showLoginStatus("Email e senha são obrigatórios.", "error"); return; } 
                showLoginStatus("A fazer login...", "loading"); 
                try { 
                    // Define a persistência NO MOMENTO DO LOGIN
                    await setPersistence(auth, remember ? browserLocalPersistence : browserSessionPersistence); 
                    
                    const userCredential = await signInWithEmailAndPassword(auth, email, password); 
                    const user = userCredential.user; 
                    const userProfileRef = ref(db, `users/${user.uid}`); 
                    const snapshot = await get(userProfileRef); 
                    const profile = snapshot.val(); 
                    
                    if (profile && profile.status === 'approved') { 
                        currentUser = user; 
                        userProfile = profile; 
                        showLoginStatus("", "success"); 
                        // Salva a intenção do utilizador no localStorage
                        if (remember) localStorage.setItem('codoc_email', email); 
                        else localStorage.removeItem('codoc_email'); 
                        showAppView(); 
                    } else if (profile && profile.status === 'pending') { 
                        showLoginStatus("A sua conta aguarda aprovação.", "warning"); 
                        await signOut(auth); 
                    } else { 
                        showLoginStatus("Acesso negado ou conta não encontrada.", "error"); 
                        await signOut(auth); 
                    } 
                } catch (error) { 
                    showLoginStatus("Email ou senha inválidos.", "error"); 
                } 
            });
            
            registerOpenBtn.addEventListener('click', () => { registerModal.style.display = "flex"; });
            
            registerSubmitBtn.addEventListener('click', async () => { const name = registerNameInput.value; const email = registerEmailInput.value; const password = registerPasswordInput.value; const confirmPassword = registerConfirmPasswordInput.value; if (!name || !email || !password) { showRegisterStatus("Todos os campos são obrigatórios.", "error"); return; } if (password !== confirmPassword) { showRegisterStatus("As senhas não coincidem.", "error"); return; } if (password.length < 6) { showRegisterStatus("A senha deve ter pelo menos 6 caracteres.", "error"); return; } showRegisterStatus("A registar...", "loading"); try { const userCredential = await createUserWithEmailAndPassword(auth, email, password); const uid = userCredential.user.uid; const userRef = ref(db, `users/${uid}`); await set(userRef, { name, email, status: "pending", role: "user" }); showRegisterStatus("", "success"); 
                showToast("Registo enviado com sucesso! A sua conta aguarda aprovação.", "success");
                closeModal('register-modal'); } catch (error) { if (error.code === 'auth/email-already-in-use') { showRegisterStatus("Este endereço de e-mail já está registado.", "error"); } else { showRegisterStatus("Erro ao registar.", "error"); } } });
            
            logoutBtn.addEventListener('click', async () => { 
                if (await showConfirm("Sair", "Tem a certeza que deseja sair?")) { 
                    if (messageListener) messageListener(); 
                    await signOut(auth); 
                    currentUser = null; 
                    userProfile = null; 
                    showLoginView(); 
                } 
            });
            
            // --- NOVO: Função de Inicialização da Autenticação ---
            async function initializeAuth() {
                // 1. Verifica se o utilizador quis ser lembrado da última vez
                const rememberMe = localStorage.getItem('codoc_email') ? true : false;
                
                try {
                    // 2. Define a persistência ANTES de verificar o login
                    await setPersistence(auth, rememberMe ? browserLocalPersistence : browserSessionPersistence);

                    // 3. O listener onAuthStateChanged agora fica AQUI DENTRO
                    onAuthStateChanged(auth, async (user) => { 
                        if (user) { 
                            // O utilizador está logado (na sessão ou local)
                            const userProfileRef = ref(db, `users/${user.uid}`); 
                            const snapshot = await get(userProfileRef); 
                            const profile = snapshot.val(); 
                            
                            if (profile && profile.status === 'approved') { 
                                currentUser = user; 
                                userProfile = profile; 
                                showAppView(); 
                            } else { 
                                // Se o perfil não for aprovado ou não existir, desloga
                                if (messageListener) messageListener(); 
                                await signOut(auth); 
                                showLoginView(); 
                            } 
                        } else { 
                            // Ninguém logado
                            if (messageListener) messageListener(); 
                            showLoginView(); 
                        } 
                    });

                } catch (error) {
                    console.error("Erro ao definir persistência:", error);
                    showLoginView(); // Se falhar, mostra o login
                }
            }
            
            // CHAMA A NOVA FUNÇÃO DE INICIALIZAÇÃO
            initializeAuth();
            
            function loadSavedLoginInfo() { 
                console.log("Tentando carregar info salva."); 
                const savedEmail = localStorage.getItem('codoc_email'); 
                if (savedEmail) { 
                    if (loginEmailInput) loginEmailInput.value = savedEmail; 
                    if (loginRememberCheck) loginRememberCheck.checked = true; 
                } 
            }

            // --- LÓGICA DA APLICAÇÃO (Visibilidade e Abas) ---
            async function showAppView() { 
                loginContainer.classList.add('hidden'); 
                mainAppContainer.classList.remove('hidden'); 
                userInfo.textContent = `Utilizador: ${userProfile.name}`; 
                if (userProfile.role === 'admin') adminBtn.classList.remove('hidden'); 
                else adminBtn.classList.add('hidden'); 
                setupMessageListener(); 
                // REMOVIDO: loadHelperData()
                await loadManagedTags(); 
                // REMOVIDO: loadAllGestaoRecords()
                await loadAllRecuperacaoDocs(); 
                renderRecuperacaoTable(); 
                // REMOVIDO: checkEliminacaoStartup()
            }
            
            function showLoginView() { loginContainer.classList.remove('hidden'); mainAppContainer.classList.add('hidden'); loadSavedLoginInfo(); }
            
            // Evento de clique nas abas (mantido, mas só tem 1 botão, então não fará mal)
            tabNavigation.addEventListener('click', (e) => { if (e.target.tagName === 'BUTTON') { const tabId = e.target.dataset.tab; tabNavigation.querySelectorAll('.tab-link').forEach(link => link.classList.remove('active')); tabContent.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active')); e.target.classList.add('active'); document.getElementById(tabId).classList.add('active'); } });
            
            // REMOVIDO: loadHelperData()

            // --- LÓGICA DA ABA 1: GESTÃO DE PROCESSOS ---
            // --- REMOVIDO ---

            // --- LÓGICA DO MODAL DE PROCESSO (Gestão) ---
            // --- REMOVIDO ---

            
            // ======================================================
            // ==== LÓGICA DA ABA 2: RECUPERAÇÃO (MODIFICADA) ====
            // ======================================================
            async function loadAllRecuperacaoDocs() { 
                try { 
                    const docRef = ref(db, 'recuperacao_documentos'); 
                    const snapshot = await get(docRef); 
                    allRecuperacaoDocs = []; 
                    if (snapshot.exists()) { 
                        const data = snapshot.val(); 
                        allRecuperacaoDocs = Object.keys(data).map(key => ({ doc_id: key, ...data[key] })); 
                    } 
                    allRecuperacaoDocs.sort((a, b) => (a.numeroProcesso || '').localeCompare(b.numeroProcesso || ''));
                } catch (error) { 
                    console.error("Erro ao carregar docs de recuperação:", error); 
                    showToast("Erro ao carregar lista de recuperação.");
                } 
            }
            
            /**
             * Função central que aplica filtros e renderiza a tabela de recuperação.
             * (VERSÃO ATUALIZADA COM CHECKBOXES)
             */
            function renderRecuperacaoTable() {
                // 1. Obter todos os valores de filtro
                const searchTerm = recSearchInput.value.toLowerCase();
                const filterUnidade = filterUnidadeSelect.value;
                const filterClassificacao = filterClassificacaoSelect.value;
                const filterDestinacao = filterDestinacaoSelect.value;
                const filterTags = filterTagsInput.value.toLowerCase();
                const filterAno = filterAnoAberturaInput.value;
                const filterDateStart = filterDataStartInput.value;
                const filterDateEnd = filterDataEndInput.value;
                const filterAtividade = filterAtividadeSelect.value;
                const filterSituacao = filterSituacaoSelect.value;
                const filterInteressado = filterInteressadoInput.value.toLowerCase();
            
                let filteredDocs = [...allRecuperacaoDocs];
            
                // 2. Aplicar Filtro de Pesquisa Rápida (Termo Geral)
                if (searchTerm) {
                    filteredDocs = filteredDocs.filter(doc => {
                        return Object.values(doc).some(val => {
                            if (Array.isArray(val)) {
                                return val.some(item => String(item).toLowerCase().includes(searchTerm));
                            }
                            return String(val).toLowerCase().includes(searchTerm);
                        });
                    });
                }
            
                // 3. Aplicar Filtros Avançados (um por um)
                if (filterUnidade) {
                    filteredDocs = filteredDocs.filter(doc => doc.unidadeTransferiu === filterUnidade);
                }
                if (filterInteressado) {
                    filteredDocs = filteredDocs.filter(doc => {
                        if (Array.isArray(doc.interessado)) {
                            return doc.interessado.some(item => String(item).toLowerCase().includes(filterInteressado));
                        }
                        return String(doc.interessado).toLowerCase().includes(filterInteressado);
                    });
                }
                if (filterAtividade) {
                    filteredDocs = filteredDocs.filter(doc => {
                        const code = doc.classificacao;
                        if (!code) return false;
                        if (filterAtividade === 'fim') return !!classificacaoCodigos.fim[code];
                        if (filterAtividade === 'meio') return !!classificacaoCodigos.meio[code];
                        return false;
                    });
                }
                if (filterClassificacao) {
                    filteredDocs = filteredDocs.filter(doc => doc.classificacao === filterClassificacao);
                }
                if (filterDestinacao) {
                    filteredDocs = filteredDocs.filter(doc => doc.destinacaoFinal === filterDestinacao);
                }
                if (filterSituacao) {
                    filteredDocs = filteredDocs.filter(doc => getSituacaoForDoc(doc) === filterSituacao);
                }
                if (filterTags) {
                    filteredDocs = filteredDocs.filter(doc => String(doc.tags).toLowerCase().includes(filterTags));
                }
                if (filterAno) {
                    filteredDocs = filteredDocs.filter(doc => doc.dataAbertura && doc.dataAbertura.startsWith(filterAno));
                }
                if (filterDateStart) {
                    filteredDocs = filteredDocs.filter(doc => doc.dataAbertura && doc.dataAbertura >= filterDateStart);
                }
                if (filterDateEnd) {
                    filteredDocs = filteredDocs.filter(doc => doc.dataAbertura && doc.dataAbertura <= filterDateEnd);
                }
            
                // 4. Obter total de registos (APÓS filtros, ANTES da paginação)
                const totalRecords = filteredDocs.length;
                recTotalRecordsSpan.textContent = totalRecords;
            
                // 5. Calcular Paginação
                const totalPages = Math.ceil(totalRecords / recRecordsPerPage) || 1;
                if (recCurrentPage > totalPages) recCurrentPage = totalPages;
            
                const startIndex = (recCurrentPage - 1) * recRecordsPerPage;
                const endIndex = recCurrentPage * recRecordsPerPage;
                const docsToRender = filteredDocs.slice(startIndex, endIndex);
            
                // 6. Renderizar Tabela
                recTableBody.innerHTML = "";
                if (docsToRender.length === 0) {
                    // ATUALIZADO: Colspan agora é 9 por causa do novo checkbox
                    recTableBody.innerHTML = '<tr class="no-results-row"><td colspan="9">Nenhum registo encontrado.</td></tr>';
                } else {
                    docsToRender.forEach(doc => {
                        const row = recTableBody.insertRow();
            
                        // (NOVO) O clique na linha só abre o modal se NÃO for no checkbox
                        row.addEventListener('click', (e) => {
                            if (e.target.type !== 'checkbox') {
                                showRecuperacaoModal(doc);
                            }
                        });
            
                        let interessadoHtml = Array.isArray(doc.interessado) ? doc.interessado.join(', ') : (doc.interessado || '');
            
                        // (NOVO) O HTML da linha agora inclui a célula do checkbox
                        row.innerHTML = `
                            <td style="width: 40px; text-align: center;">
                                <input type="checkbox" class="rec-row-check" data-doc-id="${doc.doc_id}">
                            </td>
                            <td data-key="numeroProcesso">${doc.numeroProcesso || ''}</td>
                            <td data-key="assuntoCapa">${doc.assuntoCapa || ''}</td>
                            <td data-key="interessado">${interessadoHtml}</td>
                            <td data-key="unidadeTransferiu">${doc.unidadeTransferiu || ''}</td>
                            <td data-key="dataAbertura">${doc.dataAbertura || ''}</td>
                            <td data-key="classificacao">${doc.classificacao || ''}</td>
                            <td data-key="destinacao">${doc.destinacaoFinal || ''}</td>
                            <td data-key="tags">${doc.tags || ''}</td>
                        `;
            
                        // (NOVO) Adiciona o listener no checkbox da linha
                        row.querySelector('.rec-row-check').addEventListener('click', (e) => {
                            e.stopPropagation(); // Impede o modal de abrir
                            updateDeleteButtonVisibility(); // Atualiza o botão
                            // Desmarca o "Select All" se um item for desmarcado
                            if (!e.target.checked) {
                                recSelectAllCheck.checked = false;
                            }
                        });
                    });
                }
            
                // 7. Atualizar Controlos de Paginação
                recPageNum.textContent = recCurrentPage;
                recTotalPages.textContent = totalPages;
                recPrevBtn.disabled = (recCurrentPage === 1);
                recNextBtn.disabled = (recCurrentPage === totalPages);
            
                // (NOVO) Reseta os controlos de seleção
                updateDeleteButtonVisibility(); // Atualiza o estado do botão (deve estar escondido)
                recSelectAllCheck.checked = false; // Reseta o "select all"
            }

            /**
             * Função unificada para aplicar todos os filtros e re-renderizar
             */
            function applyFilters() {
                recCurrentPage = 1;
                renderRecuperacaoTable();
            }

            // --- Listeners da Barra de Controlo (Recuperação) ---
            recSearchBtn.addEventListener('click', applyFilters);
            recSearchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    applyFilters();
                }
            });

            recRefreshBtn.addEventListener('click', async () => {
                showToast("Atualizando lista de recuperação...", "success");
                await loadAllRecuperacaoDocs();
                clearFilters(); // Limpa os filtros E renderiza a tabela
            });

            recPrevBtn.addEventListener('click', () => {
                if (recCurrentPage > 1) {
                    recCurrentPage--;
                    renderRecuperacaoTable();
                }
            });
            recNextBtn.addEventListener('click', () => {
                // Recalcula total de páginas com base nos filtros atuais (só para segurança)
                const filteredCount = allRecuperacaoDocs.filter(doc => !recSearchInput.value || Object.values(doc).some(val => String(val).toLowerCase().includes(recSearchInput.value.toLowerCase()))).length;
                const totalPages = Math.ceil(filteredCount / recRecordsPerPage) || 1;
                if (recCurrentPage < totalPages) {
                    recCurrentPage++;
                    renderRecuperacaoTable();
                }
            });

            // --- Lógica do Modal de Filtro ---
            openFilterBtn.addEventListener('click', openFilterModal);
            applyFiltersBtn.addEventListener('click', () => {
                applyFilters();
                closeModal('filter-modal');
            });
            recClearFiltersBtn.addEventListener('click', clearFilters);

            function clearFilters() {
                filterForm.reset();
                recSearchInput.value = "";
                applyFilters();
            }

            function openFilterModal() {
                // Popula os dropdowns de filtro dinamicamente
                populateFilterSelects();
                filterModal.style.display = 'flex';
            }

            function populateFilterSelects() {
                const unidades = new Set();
                const classificacoes = new Set();
                const destinacoes = new Set();

                // Coleta valores únicos de todos os documentos
                allRecuperacaoDocs.forEach(doc => {
                    if (doc.unidadeTransferiu) unidades.add(doc.unidadeTransferiu);
                    if (doc.classificacao) classificacoes.add(doc.classificacao);
                    if (doc.destinacaoFinal) destinacoes.add(doc.destinacaoFinal);
                });

                // Função auxiliar para popular um select
                const populateSelect = (selectElement, itemsSet, addDesc = false) => {
                    const currentValue = selectElement.value; // Salva o valor atual
                    selectElement.innerHTML = '<option value="">Todas</option>';
                    const sortedItems = [...itemsSet].sort();
                    
                    sortedItems.forEach(item => {
                        let text = item;
                        if (addDesc) {
                            // Tenta encontrar a descrição do código
                            const detailsFim = classificacaoCodigos.fim[item];
                            const detailsMeio = classificacaoCodigos.meio[item];
                            if (detailsFim) text = detailsFim.desc;
                            else if (detailsMeio) text = detailsMeio.desc;
                            else text = `${item} (Código antigo)`;
                        }
                        const option = new Option(text, item);
                        selectElement.appendChild(option);
                    });
                    selectElement.value = currentValue; // Restaura o valor
                };

                // Popula os selects
                populateSelect(filterUnidadeSelect, unidades);
                populateSelect(filterDestinacaoSelect, destinacoes);
                populateSelect(filterClassificacaoSelect, classificacoes, true); // true = adicionar descrição
                
                // Popula o filtro de Situação (é estático)
                const currentSituacao = filterSituacaoSelect.value;
                filterSituacaoSelect.innerHTML = '<option value="">Todas</option>';
                situacaoValores.forEach(sit => {
                    filterSituacaoSelect.appendChild(new Option(sit, sit));
                });
                filterSituacaoSelect.value = currentSituacao;
            }


            // --- Lógica do Modal de Registo (TTD) ---
            
            function updateClassificacaoOptions(valorSalvo = null) {
                const tipo = recTipoAtividadeSelect.value;
                recClassificacaoSelect.innerHTML = ""; 

                let listaCodigos = {};
                if (tipo === 'fim') {
                    listaCodigos = classificacaoCodigos.fim;
                } else if (tipo === 'meio') {
                    listaCodigos = classificacaoCodigos.meio;
                }

                recClassificacaoSelect.appendChild(new Option("Selecione...", ""));

                let valorSalvoEncontrado = false;
                if (valorSalvo) {
                    // Verifica se o valor salvo existe em qualquer lista (fim ou meio)
                    if (classificacaoCodigos.fim[valorSalvo] || classificacaoCodigos.meio[valorSalvo]) {
                        valorSalvoEncontrado = true;
                    } else {
                        // Se não existe mais na lista (foi apagado), adiciona como "Valor Salvo"
                        const opt = new Option(`${valorSalvo} (Valor Salvo)`, valorSalvo);
                        opt.selected = true;
                        recClassificacaoSelect.appendChild(opt);
                    }
                }

                for (const [codigo, details] of Object.entries(listaCodigos)) {
                    // Agora usa 'details.desc' para o texto
                    const opt = new Option(details.desc, codigo);
                    if (valorSalvoEncontrado && codigo === valorSalvo) {
                        opt.selected = true; 
                    }
                    recClassificacaoSelect.appendChild(opt);
                }
            }
            
            openRecuperacaoFormBtn.addEventListener('click', () => showRecuperacaoModal(null));

            function showRecuperacaoModal(doc = null) {
                recuperacaoForm.reset();
                recuperacaoStatus.textContent = "";
                recDocIdInput.value = "";
                recInteressadoList.innerHTML = ""; // Limpa a lista de interessados
                const modalTitle = document.getElementById('recuperacao-modal-title');

                if (doc) {
                    modalTitle.textContent = "Editar/Visualizar Registo";
                    recDocIdInput.value = doc.doc_id;

                    document.getElementById('rec-numero-processo').value = doc.numeroProcesso || '';
                    document.getElementById('rec-assunto-capa').value = doc.assuntoCapa || '';
                    
                    // NOVO: Popula a lista de interessados
                    if (Array.isArray(doc.interessado)) {
                        doc.interessado.forEach(name => addInteressadoToList(name));
                    } else if (doc.interessado) { // Compatibilidade com dados antigos (string)
                        addInteressadoToList(doc.interessado);
                    }

                    document.getElementById('rec-unidade-transferiu').value = doc.unidadeTransferiu || '';
                    document.getElementById('rec-data-transferencia').value = doc.dataTransferencia || '';
                    document.getElementById('rec-data-abertura').value = doc.dataAbertura || '';
                    document.getElementById('rec-ano-vigencia').value = doc.anoFimVigencia || '';
                    document.getElementById('rec-tags').value = doc.tags || '';
                    
                    const codSalvo = doc.classificacao || null;
                    let tipoEncontrado = "";
                    if (codSalvo) {
                        if (classificacaoCodigos.fim[codSalvo]) {
                            tipoEncontrado = "fim";
                        } else if (classificacaoCodigos.meio[codSalvo]) {
                            tipoEncontrado = "meio";
                        }
                    }
                    recTipoAtividadeSelect.value = tipoEncontrado;
                    
                    updateClassificacaoOptions(codSalvo); 
                    
                    // ATUALIZADO: Chama a nova lógica
                    // O 'false' impede que o 'anoFimVigencia' (S3) seja apagado ao abrir
                    handleClassificacaoChange(false); 

                    recuperacaoDeleteBtn.classList.remove('hidden');
                } else {
                    modalTitle.textContent = "Registo/Recuperação Docs";
                    recuperacaoDeleteBtn.classList.add('hidden');
                    
                    updateClassificacaoOptions(null); 
                    
                    // ATUALIZADO: Chama a nova lógica
                    // O 'true' garante que os campos estão limpos ao adicionar novo
                    handleClassificacaoChange(true);
                }
                
                recuperacaoFormModal.style.display = "flex";
            }

            // ======================================================
            // ==== NOVAS FUNÇÕES DE INTERESSADO (MÚLTIPLO) ====
            // ======================================================

            // Adiciona um interessado ao clicar no botão '+'
            recInteressadoAddBtn.addEventListener('click', () => {
                const name = recInteressadoInput.value.trim();
                if (name) {
                    addInteressadoToList(name);
                    recInteressadoInput.value = "";
                    recInteressadoInput.focus();
                }
            });

            // Adiciona um interessado ao pressionar Enter no input
            recInteressadoInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault(); // Impede o formulário de ser submetido
                    recInteressadoAddBtn.click();
                }
            });

            /**
             * Adiciona um nome à lista de interessados na UI.
             * @param {string} name - O nome a ser adicionado.
             */
            function addInteressadoToList(name) {
                const li = document.createElement('li');
                li.textContent = name;

                const removeBtn = document.createElement('button');
                removeBtn.type = "button";
                removeBtn.className = "remove-item-btn";
                removeBtn.textContent = "X";
                removeBtn.title = "Remover";
                
                removeBtn.addEventListener('click', () => {
                    li.remove();
                });

                li.appendChild(removeBtn);
                recInteressadoList.appendChild(li);
            }


            // ======================================================
            // ==== NOVAS FUNÇÕES DE CÁLCULO DE PRAZO (ABA 2) ====
            // ======================================================

            // Listener principal que dispara a lógica de UI
            recClassificacaoSelect.addEventListener('change', () => handleClassificacaoChange(true));
            
            // Listeners que disparam o recálculo da situação
            recDataAberturaInput.addEventListener('change', calcularSituacao);
            recAnoVigenciaInput.addEventListener('input', calcularSituacao);
            
            recTipoAtividadeSelect.addEventListener('change', () => {
                // Atualiza as opções de classificação e reseta a UI
                updateClassificacaoOptions(null);
                handleClassificacaoChange(true);
            });


            /**
             * Controla a UI do formulário com base na Classificação selecionada.
             * @param {boolean} clearVigencia - Se true, limpa o campo 'Ano Fim Vigência' (para novos)
             */
            function handleClassificacaoChange(clearVigencia = true) {
                const tipo = recTipoAtividadeSelect.value;
                const codigo = recClassificacaoSelect.value;
                
                if (!tipo || !codigo || !classificacaoCodigos[tipo] || !classificacaoCodigos[tipo][codigo]) {
                    // Reseta e habilita campos se "Selecione..." for escolhido
                    recDestinacaoSelect.value = "";
                    recDestinacaoSelect.disabled = false;
                    recDataEliminacaoGroup.classList.add('hidden');
                    recAnoVigenciaGroup.classList.add('hidden');
                    if (clearVigencia) recAnoVigenciaInput.value = "";
                } else {
                    const details = classificacaoCodigos[tipo][codigo];
                    
                    // 1. Define Destinação e desabilita
                    recDestinacaoSelect.value = details.destinacao;
                    recDestinacaoSelect.disabled = true;

                    // 2. Mostra/Esconde Data Eliminação (baseado na destinação)
                    if (details.destinacao === 'Eliminação') {
                        recDataEliminacaoGroup.classList.remove('hidden');
                    } else {
                        recDataEliminacaoGroup.classList.add('hidden');
                        document.getElementById('rec-data-eliminacao').value = "";
                    }

                    // 3. Mostra/Esconde Ano Vigência (baseado no prazo corrente)
                    if (details.prazoCorrente === "VIGÊNCIA") {
                        recAnoVigenciaGroup.classList.remove('hidden');
                    } else {
                        recAnoVigenciaGroup.classList.add('hidden');
                        if (clearVigencia) recAnoVigenciaInput.value = "";
                    }
                }
                // (Re)Calcula a situação sempre que a classificação mudar
                calcularSituacao();
            }

            /**
             * Calcula a Situação do Prazo e exibe no input do formulário.
             */
            function calcularSituacao() {
                // Pega os valores do *formulário*
                const tipo = recTipoAtividadeSelect.value;
                const codigo = recClassificacaoSelect.value;
                const dataAberturaStr = recDataAberturaInput.value;
                const anoVigenciaStr = recAnoVigenciaInput.value;

                // Usa a função de cálculo e define o valor do input
                const situacao = getSituacaoForDoc({
                    classificacao: codigo,
                    dataAbertura: dataAberturaStr,
                    anoFimVigencia: anoVigenciaStr
                }, tipo); // Passa o 'tipo' como segundo argumento

                recSituacaoInput.value = situacao;
            }

            /**
             * Calcula e RETORNA a Situação do Prazo para um documento.
             * @param {object} doc - O objeto do documento (pode ser parcial, vindo do filtro).
             * @param {string} [activityType] - O tipo de atividade ('fim' ou 'meio'), se já conhecido.
             */
            function getSituacaoForDoc(doc, activityType = null) {
                // 1. Get code details
                const codigo = doc.classificacao;
                if (!codigo) return "";

                let tipo = activityType;
                let details;

                // Se o tipo não foi passado, descobre
                if (!tipo) {
                    if (classificacaoCodigos.fim[codigo]) {
                        tipo = 'fim';
                        details = classificacaoCodigos.fim[codigo];
                    } else if (classificacaoCodigos.meio[codigo]) {
                        tipo = 'meio';
                        details = classificacaoCodigos.meio[codigo];
                    } else {
                        return ""; // Código inválido
                    }
                } else {
                    details = classificacaoCodigos[tipo]?.[codigo];
                }

                if (!details) return ""; // Não encontrou

                // 2. Get dates and terms
                const dataAberturaStr = doc.dataAbertura; // (C3)
                const anoVigenciaStr = doc.anoFimVigencia; // (S3)
                const P3 = details.prazoCorrente; // (P3)
                const Q3 = details.prazoIntermediario; // (Q3)
                const R3 = details.destinacao; // (R3)

                // 3. Handle "Guarda Permanente"
                if (R3 === "Guarda Permanente") {
                    return "DOCUMENTO DE GUARDA PERMANENTE";
                }

                // 4. Get years
                const todayYear = new Date().getFullYear();
                let startYear; // Ano(C3)

                try {
                    if (!dataAberturaStr) { 
                        return "Aguardando Data de Abertura";
                    }
                    startYear = new Date(dataAberturaStr + "T12:00:00").getFullYear();
                    if (isNaN(startYear)) throw new Error("Data inválida");
                } catch (e) {
                    return "Data de Abertura inválida";
                }

                // 5. Logic for P3 = "VIGÊNCIA"
                if (P3 === "VIGÊNCIA") {
                    const anoVigenciaNum = parseInt(anoVigenciaStr, 10);
                    if (isNaN(anoVigenciaNum) || String(anoVigenciaNum).length < 4) { 
                        return "AGUARDANDO O ANO DO FIM DA VIGÊNCIA";
                    }
                    
                    if (anoVigenciaNum < startYear) { 
                         return "Ano Fim Vigência anterior à Data Abertura";
                    }
                    
                    // Core Logic: (Ano(S3) + Q3) >= Ano(HOJE())
                    if ((anoVigenciaNum + Q3) >= todayYear) {
                        return "MANTER EM GUARDA ATÉ O PRAZO FINAL";
                    } else {
                        return "ENCAMINHAR PARA ELIMINAÇÃO";
                    }
                
                // 6. Logic for P3 = number (Standard)
                } else {
                    // Core Logic: (Ano(C3) + P3 + Q3) >= Ano(HOJE())
                    if ((startYear + P3 + Q3) >= todayYear) {
                        return "MANTER EM GUARDA ATÉ O PRAZO FINAL";
                    } else {
                        return "ENCAMINHAR PARA ELIMINAÇÃO";
                    }
                }
            }


            recuperacaoSaveBtn.addEventListener('click', async () => { 
                const numeroProcesso = document.getElementById('rec-numero-processo').value; 
                if (!numeroProcesso) { recuperacaoStatus.textContent = "Nº Processo obrigatório."; recuperacaoStatus.className = "status-error"; return; } 
                
                // NOVO: Lê os interessados da lista
                const interessadosArray = [];
                recInteressadoList.querySelectorAll('li').forEach(li => {
                    // Pega o textContent e remove o 'X' do botão
                    interessadosArray.push(li.firstChild.textContent.trim());
                });

                const docId = recDocIdInput.value; 
                const docData = { 
                    numeroProcesso, 
                    assuntoCapa: document.getElementById('rec-assunto-capa').value, 
                    interessado: interessadosArray, // Salva o array
                    unidadeTransferiu: document.getElementById('rec-unidade-transferiu').value, 
                    dataTransferencia: document.getElementById('rec-data-transferencia').value, 
                    dataAbertura: document.getElementById('rec-data-abertura').value, 
                    anoFimVigencia: document.getElementById('rec-ano-vigencia').value, 
                    classificacao: recClassificacaoSelect.value, 
                    destinacaoFinal: document.getElementById('rec-destinacao-final').value, 
                    dataEliminacao: document.getElementById('rec-data-eliminacao').value, 
                    tags: document.getElementById('rec-tags').value
                }; 
                
                if (docData.destinacaoFinal !== 'Eliminação') docData.dataEliminacao = ""; 
                
                recuperacaoStatus.textContent = "Salvando..."; 
                recuperacaoStatus.className = "status-loading"; 
                
                try {
                    if (docId) {
                        const docRef = ref(db, `recuperacao_documentos/${docId}`);
                        await update(docRef, docData);
                        recuperacaoStatus.textContent = "Registo Atualizado!";
                        recuperacaoStatus.className = "status-success";
                    } else {
                        docData.registadoPor = userProfile.name;
                        docData.registadoEm = new Date().toISOString();
                        const docListRef = ref(db, 'recuperacao_documentos');
                        await push(docListRef, docData);
                        recuperacaoStatus.textContent = "Registado!";
                        recuperacaoStatus.className = "status-success";
                    }
                    
                    setTimeout(async () => {
                        closeModal('recuperacao-form-modal');
                        await loadAllRecuperacaoDocs(); 
                        renderRecuperacaoTable(); 
                    }, 1500);

                } catch (error) { 
                    recuperacaoStatus.textContent = `Erro: ${error.message}`; 
                    recuperacaoStatus.className = "status-error"; 
                } 
            });

            recuperacaoDeleteBtn.addEventListener('click', async () => {
                const docId = recDocIdInput.value;
                if (!docId) return;
                const processoNum = document.getElementById('rec-numero-processo').value;
                
                if (!await showConfirm("Confirmar Remoção", `Tem a certeza que deseja remover o registo:\n${processoNum}\n\nEsta ação não pode ser desfeita.`)) {
                    return;
                }

                recuperacaoStatus.textContent = "Removendo...";
                recuperacaoStatus.className = "status-loading";

                try {
                    await remove(ref(db, `recuperacao_documentos/${docId}`));
                    recuperacaoStatus.textContent = "Registo removido!";
                    recuperacaoStatus.className = "status-success";

                    setTimeout(async () => {
                        closeModal('recuperacao-form-modal');
                        await loadAllRecuperacaoDocs();
                        recCurrentPage = 1; 
                        renderRecuperacaoTable();
                    }, 1500);

                } catch (error) {
                    recuperacaoStatus.textContent = `Erro: ${error.message}`;
                    recuperacaoStatus.className = "status-error";
                }
            });

            // =================================================================
            // ==== NOVAS FUNÇÕES E LISTENERS (SELEÇÃO MÚLTIPLA) ====
            // =================================================================
            
            /**
             * (NOVO) Atualiza a visibilidade e o contador do botão "Remover Selecionados".
             */
            function updateSelectionButtonsVisibility() {
                            const checkedBoxes = document.querySelectorAll('#rec-table-body .rec-row-check:checked');
                            const count = checkedBoxes.length;
            
                            if (count > 0) {
                                // Botão de Remover
                                recDeleteSelectedBtn.classList.remove('hidden');
                                recDeleteSelectedBtn.textContent = `Remover Selecionados (${count})`;
                                // Botão de Classificar
                                recClassifySelectedBtn.classList.remove('hidden');
                                recClassifySelectedBtn.textContent = `Classificar em Lote (${count})`;
                            } else {
                                // Botão de Remover
                                recDeleteSelectedBtn.classList.add('hidden');
                                recDeleteSelectedBtn.textContent = 'Remover Selecionados (0)';
                                // Botão de Classificar
                                recClassifySelectedBtn.classList.add('hidden');
                                recClassifySelectedBtn.textContent = 'Classificar em Lote (0)';
                            }
                        }
            
            /**
             * (NOVO) Listener para o checkbox "Selecionar Todos" no cabeçalho.
             */
            recSelectAllCheck.addEventListener('click', () => {
                const isChecked = recSelectAllCheck.checked;
                const rowChecks = document.querySelectorAll('#rec-table-body .rec-row-check');
                rowChecks.forEach(check => {
                    check.checked = isChecked;
                });
                updateDeleteButtonVisibility();
            });
            
            /**
             * (NOVO) Listener para o botão "Remover Selecionados".
             */
            recDeleteSelectedBtn.addEventListener('click', async () => {
                const checkedBoxes = document.querySelectorAll('#rec-table-body .rec-row-check:checked');
                if (checkedBoxes.length === 0) return;
            
                const docIdsToDelete = [];
                checkedBoxes.forEach(check => {
                    docIdsToDelete.push(check.dataset.docId);
                });
            
                // Usa o modal de confirmação existente
                const confirmed = await showConfirm(
                    "Confirmar Remoção em Massa",
                    `Tem a certeza que deseja remover ${docIdsToDelete.length} registo(s)?\n\nEsta ação não pode ser desfeita.`
                );
            
                if (confirmed) {
                    showToast(`Removendo ${docIdsToDelete.length} registos...`, "success");
                    try {
                        // Cria um array de promessas de remoção
                        const deletePromises = docIdsToDelete.map(id => {
                            return remove(ref(db, `recuperacao_documentos/${id}`));
                        });
            
                        // Espera todas as promessas terminarem
                        await Promise.all(deletePromises);
            
                        showToast(`${docIdsToDelete.length} registos removidos!`, "success");
            
                        await loadAllRecuperacaoDocs(); // Recarregar dados
                        renderRecuperacaoTable(); // Re-renderizar tabela
            
                    } catch (error) {
                        console.error("Erro ao remover em massa:", error);
                        showToast(`Erro ao remover registos: ${error.message}`, "error");
                    }
                }
            });
            
            // =================================================================
            // ==== FIM DAS NOVAS FUNÇÕES (SELEÇÃO MÚLTIPLA) ====
            // =================================================================
            // =================================================================
            // ==== NOVAS FUNÇÕES (CLASSIFICAÇÃO EM LOTE) ====
            // =================================================================

            /**
             * (NOVO) Abre o modal de classificação em lote
             */
            recClassifySelectedBtn.addEventListener('click', () => {
                const checkedBoxes = document.querySelectorAll('#rec-table-body .rec-row-check:checked');
                if (checkedBoxes.length === 0) return;

                batchClassifyForm.reset();
                batchClassifyStatus.textContent = "";
                batchRecDestinacaoInput.value = "";
                batchRecDestinacaoInput.disabled = true;
                batchClassifyCount.textContent = checkedBoxes.length;
                
                // Popula os dropdowns
                updateBatchClassificacaoOptions(null);
                
                batchClassifyModal.style.display = 'flex';
            });

            /**
             * (NOVO) Popula o dropdown de classificação do modal BATCH
             */
            function updateBatchClassificacaoOptions(valorSalvo = null) {
                const tipo = batchRecTipoAtividadeSelect.value;
                batchRecClassificacaoSelect.innerHTML = ""; // Limpa opções

                let listaCodigos = {};
                if (tipo === 'fim') {
                    listaCodigos = classificacaoCodigos.fim;
                } else if (tipo === 'meio') {
                    listaCodigos = classificacaoCodigos.meio;
                }

                batchRecClassificacaoSelect.appendChild(new Option("Selecione a Classificação...", ""));

                // Popula com os códigos corretos
                for (const [codigo, details] of Object.entries(listaCodigos)) {
                    const opt = new Option(details.desc, codigo);
                    if (valorSalvo && codigo === valorSalvo) {
                        opt.selected = true; 
                    }
                    batchRecClassificacaoSelect.appendChild(opt);
                }
            }

            // (NOVO) Listener para o Tipo de Atividade (Batch)
            batchRecTipoAtividadeSelect.addEventListener('change', () => {
                updateBatchClassificacaoOptions(null);
                batchRecDestinacaoInput.value = ""; // Limpa destinação
                batchRecDestinacaoInput.disabled = true;
            });

            // (NOVO) Listener para a Classificação (Batch) - Define a destinação
            batchRecClassificacaoSelect.addEventListener('change', () => {
                const tipo = batchRecTipoAtividadeSelect.value;
                const codigo = batchRecClassificacaoSelect.value;

                if (tipo && codigo && classificacaoCodigos[tipo] && classificacaoCodigos[tipo][codigo]) {
                    const details = classificacaoCodigos[tipo][codigo];
                    batchRecDestinacaoInput.value = details.destinacao;
                    batchRecDestinacaoInput.disabled = true;
                } else {
                    batchRecDestinacaoInput.value = "";
                    batchRecDestinacaoInput.disabled = true;
                }
            });

            /**
             * (NOVO) Salva as alterações de classificação em lote
             */
            batchClassifySaveBtn.addEventListener('click', async () => {
                const newClassificacao = batchRecClassificacaoSelect.value;
                const newDestinacao = batchRecDestinacaoInput.value;
                const tagsToAddStr = batchRecTagsInput.value;

                // Validação
                if (!newClassificacao) {
                    batchClassifyStatus.textContent = "Por favor, selecione uma classificação válida.";
                    return;
                }

                const checkedBoxes = document.querySelectorAll('#rec-table-body .rec-row-check:checked');
                if (checkedBoxes.length === 0) {
                    batchClassifyStatus.textContent = "Nenhum item selecionado.";
                    return;
                }

                const docIdsToUpdate = Array.from(checkedBoxes).map(cb => cb.dataset.docId);

                if (!await showConfirm("Classificar em Lote", `Tem a certeza que deseja aplicar a classificação:\n${newClassificacao}\n\nA ${docIdsToUpdate.length} registo(s)?\nIsto irá sobrescrever a classificação e destinação existentes.`)) {
                    return;
                }

                batchClassifyStatus.textContent = "Processando lote...";
                batchClassifyStatus.className = "status-loading";

                try {
                    const updates = {};
                    const newTagsList = tagsToAddStr.split(',').map(t => t.trim()).filter(Boolean);

                    for (const docId of docIdsToUpdate) {
                        // Path para os campos a atualizar
                        const classPath = `recuperacao_documentos/${docId}/classificacao`;
                        const destPath = `recuperacao_documentos/${docId}/destinacaoFinal`;
                        const tagsPath = `recuperacao_documentos/${docId}/tags`;

                        // Define a nova classificação e destinação
                        updates[classPath] = newClassificacao;
                        updates[destPath] = newDestinacao;

                        // Lógica para ADICIONAR tags (sem duplicar)
                        if (newTagsList.length > 0) {
                            const doc = allRecuperacaoDocs.find(d => d.doc_id === docId);
                            const existingTagsList = (doc.tags || "").split(',').map(t => t.trim()).filter(Boolean);
                            
                            // Junta as listas e remove duplicados
                            const combinedTags = [...new Set([...existingTagsList, ...newTagsList])];
                            updates[tagsPath] = combinedTags.join(', ');
                        }
                    }

                    // Envia uma única atualização em lote para o Firebase
                    await update(ref(db), updates);

                    showToast(`Sucesso! ${docIdsToUpdate.length} registos atualizados.`, "success");
                    closeModal('batch-classify-modal');

                    // Recarrega os dados e renderiza a tabela
                    await loadAllRecuperacaoDocs();
                    renderRecuperacaoTable(); // Isto irá desmarcar tudo e esconder os botões

                } catch (error) {
                    console.error("Erro ao classificar em lote:", error);
                    batchClassifyStatus.textContent = `Erro: ${error.message}`;
                    batchClassifyStatus.className = "status-error";
                }
            });

            // =================================================================
            // ==== FIM DAS NOVAS FUNÇÕES (CLASSIFICAÇÃO EM LOTE) ====
            // =================================================================
            const headerMapping = { 'número do processo': 'numeroProcesso', 'numeroprocesso': 'numeroProcesso', 'assunto da capa': 'assuntoCapa', 'assuntocapa': 'assuntoCapa', 'interessado': 'interessado', 'unidade que transferiu o processo': 'unidadeTransferiu', 'unidade que transferiu': 'unidadeTransferiu', 'unidadetransferiu': 'unidadeTransferiu', 'data de transferência (data da ltd)': 'dataTransferencia', 'data de transferência': 'dataTransferencia', 'datatransferencia': 'dataTransferencia', 'data de abertura do processo': 'dataAbertura', 'data de abertura': 'dataAbertura', 'dataabertura': 'dataAbertura', 'ano de fim da vigência': 'anoFimVigencia', 'anofimvigencia': 'anoFimVigencia', 'classificação': 'classificacao', 'classificacao': 'classificacao', 'destinação final': 'destinacaoFinal', 'destinacaofinal': 'destinacaoFinal', 'data da eliminação': 'dataEliminacao', 'dataeliminacao': 'dataEliminacao', 'tags': 'tags' };
            
            importRecBtn.addEventListener('click', () => {
                importRecInput.click();
            }); 
            
            importRecInput.addEventListener('change', handleImportFile);
            async function handleImportFile(event) { const file = event.target.files[0]; if (!file) return; recTableBody.innerHTML = '<tr class="no-results-row"><td colspan="8">Processando...</td></tr>'; const reader = new FileReader(); reader.onload = async (e) => { try { const data = e.target.result; const workbook = XLSX.read(data, { type: 'array', cellDates: true, cellNF: false, cellText: false }); const firstSheetName = workbook.SheetNames[0]; const worksheet = workbook.Sheets[firstSheetName]; const jsonData = XLSX.utils.sheet_to_json(worksheet, { raw: false, dateNF: 'yyyy-mm-dd' }); if (!jsonData || jsonData.length === 0) throw new Error("Planilha vazia."); const processedRows = []; for (const row of jsonData) { const docData = { registadoPor: userProfile.name, registadoEm: new Date().toISOString() }; let hasNumeroProcesso = false; for (const [key, value] of Object.entries(row)) { const normalizedKey = key.toLowerCase().trim(); if (headerMapping[normalizedKey]) { const firebaseKey = headerMapping[normalizedKey]; if (value instanceof Date) { docData[firebaseKey] = value.toISOString().split('T')[0]; } else if (['dataTransferencia', 'dataAbertura', 'dataEliminacao'].includes(firebaseKey) && typeof value === 'string' && value.includes('/')) { const parts = value.split('/'); if (parts.length === 3) docData[firebaseKey] = `${parts[2]}-${parts[1].padStart(2, '0')}-${parts[0].padStart(2, '0')}`; else docData[firebaseKey] = value; } else if (firebaseKey === 'interessado' && typeof value === 'string') { // NOVO: Converte interessado em array
                                docData[firebaseKey] = value.split(/[,;]/).map(s => s.trim()).filter(Boolean);
                            } else { docData[firebaseKey] = value; } if (firebaseKey === 'numeroProcesso' && value) hasNumeroProcesso = true; } } if (hasNumeroProcesso) processedRows.push(docData); } if (processedRows.length === 0) throw new Error("Nenhum registo válido encontrado."); recTableBody.innerHTML = `<tr class="no-results-row"><td colspan="8">Importando ${processedRows.length}...</td></tr>`; const docListRef = ref(db, 'recuperacao_documentos'); const uploadPromises = processedRows.map(docData => push(docListRef, docData)); await Promise.all(uploadPromises); 
                showToast(`Sucesso! ${processedRows.length} importados.`, "success"); 
                await loadAllRecuperacaoDocs(); recCurrentPage = 1; renderRecuperacaoTable(); } catch (error) { 
                showToast(`Erro na importação: ${error.message}`); 
                renderRecuperacaoTable(); } finally { importRecInput.value = ""; } }; reader.readAsArrayBuffer(file); }

            // --- LÓGICA DE ADMIN (SEM MUDANÇAS NAS FUNÇÕES, SÓ SEM ALERTS) ---
            adminBtn.addEventListener('click', () => adminModal.style.display = 'flex');
            
            // REMOVIDO: adminGestaoCoresBtn e suas funções (renderColorManagementTable, addColorRuleBtn, editColorRule, saveColorRuleBtn, deleteColorRuleBtn)
            
            function setupMessageListener() { if (messageListener) messageListener(); const messagesRef = ref(db, 'messages'); messageListener = onValue(messagesRef, (snapshot) => { allMessages = {}; let unreadCount = 0; if (snapshot.exists()) { allMessages = snapshot.val(); const uid = currentUser.uid; const role = userProfile.role; for (const [id, msg] of Object.entries(allMessages)) { const isForMe = msg.recipient === 'Todos' || msg.recipient === uid || (msg.recipient === 'Somente Admins' && role === 'admin'); if (isForMe && !(msg.read_by && msg.read_by[uid])) unreadCount++; } } if (unreadCount > 0) { messageBadge.textContent = unreadCount; messageBadge.classList.remove('hidden'); } else { messageBadge.classList.add('hidden'); } }); }
            messagesBtn.addEventListener('click', () => { renderMessagesTable(); viewMessagesModal.style.display = 'flex'; });
            function renderMessagesTable() { viewMessagesTableBody.innerHTML = ""; messageContentDiv.innerHTML = "<p>Selecione uma mensagem.</p>"; const uid = currentUser.uid; const role = userProfile.role; const myMessages = []; for (const [id, msg] of Object.entries(allMessages)) { const isForMe = msg.recipient === 'Todos' || msg.recipient === uid || (msg.recipient === 'Somente Admins' && role === 'admin'); if (isForMe) myMessages.push({ id, ...msg }); } myMessages.sort((a, b) => (b.timestamp || '').localeCompare(a.timestamp || '')); if (myMessages.length === 0) { viewMessagesTableBody.innerHTML = '<tr class="no-results-row"><td colspan="2">Nenhuma mensagem.</td></tr>'; return; } myMessages.forEach(msg => { const isUnread = !(msg.read_by && msg.read_by[uid]); const row = viewMessagesTableBody.insertRow(); row.dataset.msgId = msg.id; if (isUnread) row.classList.add('unread'); row.innerHTML = ` <td data-key="from">${msg.sender_name || 'Sistema'}</td> <td data-key="timestamp">${msg.timestamp || ''}</td> `; row.addEventListener('click', () => showMessageContent(msg.id, row)); }); }
            async function showMessageContent(msgId, rowElement) { const msg = allMessages[msgId]; if (!msg) return; messageContentDiv.textContent = msg.message; if (rowElement.classList.contains('unread')) { try { await set(ref(db, `messages/${msgId}/read_by/${currentUser.uid}`), true); rowElement.classList.remove('unread'); } catch (error) { console.warn("Erro:", error); } } }
            adminEnviarMsgBtn.addEventListener('click', async () => { sendMessageStatus.textContent = ""; sendMessageModal.style.display = 'flex'; sendMessageRecipient.innerHTML = '<option value="">Carregando...</option>'; try { const snapshot = await get(ref(db, 'users')); const users = snapshot.val(); let options = '<option value="Todos">Todos</option>'; options += '<option value="Somente Admins">Somente Admins</option>'; for (const [uid, user] of Object.entries(users)) if (user.status === 'approved') options += `<option value="${uid}">${user.name} (${user.email})</option>`; sendMessageRecipient.innerHTML = options; } catch (error) { sendMessageRecipient.innerHTML = '<option value="">Erro</option>'; } });
            
            sendMessageBtn.addEventListener('click', async () => { const recipient = sendMessageRecipient.value; const message = sendMessageContent.value; if (!recipient || !message) { sendMessageStatus.className = "status-error"; sendMessageStatus.textContent = "Campos obrigatórios."; return; } sendMessageStatus.className = "status-loading"; sendMessageStatus.textContent = "Enviando..."; const messageData = { sender_id: currentUser.uid, sender_name: userProfile.name, recipient, message, timestamp: new Date().toISOString().slice(0, 19).replace('T', ' '), read_by: {} }; try { await push(ref(db, 'messages'), messageData); 
                showToast("Mensagem Enviada!", "success"); 
                closeModal('send-message-modal'); sendMessageContent.value = ""; } catch (error) { sendMessageStatus.className = "status-error"; sendMessageStatus.textContent = "Erro: " + error.message; } });
            
            adminGestaoTagsBtn.addEventListener('click', async () => { if (userProfile && userProfile.role === 'admin') { await loadManagedTags(); renderTagManagementTable(); tagManagementModal.style.display = 'flex'; } else { showToast("Acesso negado."); } });
            async function loadManagedTags() { try { if (!currentUser || !userProfile) return; const snapshot = await get(ref(db, 'managed_tags/recuperacao')); managedTags = snapshot.exists() ? snapshot.val() : {}; } catch (error) { managedTags = {}; } }
            
            function renderTagManagementTable() { tagManagementTableBody.innerHTML = ""; const sortedTags = Object.entries(managedTags).sort(([, a], [, b]) => (a.name || '').localeCompare(b.name || '')); if (sortedTags.length === 0) { tagManagementTableBody.innerHTML = '<tr class="no-results-row"><td colspan="2">Nenhuma tag.</td></tr>'; return; } sortedTags.forEach(([id, tag]) => { const row = tagManagementTableBody.insertRow(); row.dataset.tagId = id; row.style.cursor = 'pointer'; row.title = 'Clique p/ editar'; row.innerHTML = ` <td data-key="tagName">${tag.name}</td> <td data-key="actions" style="text-align: center;"> <button class="button button-small" data-action="delete" title="Remover" style="background-color: var(--cor-erro); padding: 5px 8px; font-size: 0.8em;">X</button> </td> `; row.cells[0].addEventListener('click', () => { showTagEditModal(id); }); const deleteButton = row.querySelector('button[data-action="delete"]'); if (deleteButton) { 
                deleteButton.addEventListener('click', async (e) => {
                    e.stopPropagation(); const tagIdToDelete = row.dataset.tagId; const tagName = row.cells[0].textContent; 
                    if (tagIdToDelete && await showConfirm("Confirmar Remoção", `Remover "${tagName}"?`)) {
                        try { await remove(ref(db, `managed_tags/recuperacao/${tagIdToDelete}`)); await loadManagedTags(); renderTagManagementTable(); } catch (error) { showToast("Erro: " + error.message); } 
                    } 
                }); 
            } }); }
            
            addNewTagBtn.addEventListener('click', () => showTagEditModal(null));
            function showTagEditModal(tagId) { tagEditForm.reset(); tagEditStatus.textContent = ''; tagEditIdInput.value = tagId || ''; if (tagId && managedTags[tagId]) { tagEditModalTitle.textContent = "Editar Tag"; tagEditNameInput.value = managedTags[tagId].name; } else { tagEditModalTitle.textContent = "Adicionar Tag"; } tagEditModal.style.display = 'flex'; tagEditNameInput.focus(); }
            saveTagBtn.addEventListener('click', async () => { const tagId = tagEditIdInput.value; const tagName = tagEditNameInput.value.trim(); tagEditStatus.textContent = ''; if (!tagName) { tagEditStatus.textContent = "Nome vazio."; return; } const lowerTagName = tagName.toLowerCase(); const tagExists = Object.entries(managedTags).some(([id, tag]) => id !== tagId && tag.name.toLowerCase() === lowerTagName); if (tagExists) { tagEditStatus.textContent = "Tag já existe."; return; } const tagData = { name: tagName }; const path = tagId ? `managed_tags/recuperacao/${tagId}` : `managed_tags/recuperacao`; try { if (tagId) await set(ref(db, path), tagData); else await push(ref(db, path), tagData); closeModal('tag-edit-modal'); await loadManagedTags(); renderTagManagementTable(); } catch (error) { tagEditStatus.textContent = "Erro: " + error.message; } });
            tagEditNameInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') { e.preventDefault(); saveTagBtn.click(); } });
            
            adminGestaoUsersBtn.addEventListener('click', async () => { if (userProfile && userProfile.role === 'admin') { await loadAllUsers(); renderUserManagementTable(); userManagementModal.style.display = 'flex'; } else { showToast("Acesso negado."); } });
            refreshUsersBtn.addEventListener('click', async () => { await loadAllUsers(); renderUserManagementTable(); });
            async function loadAllUsers() { try { const snapshot = await get(ref(db, 'users')); allUsers = snapshot.exists() ? snapshot.val() : {}; } catch (error) { allUsers = {}; showToast("Erro ao carregar users."); } }
            function renderUserManagementTable() { userManagementTableBody.innerHTML = ""; if (Object.keys(allUsers).length === 0) { userManagementTableBody.innerHTML = '<tr class="no-results-row"><td colspan="5">Nenhum user.</td></tr>'; return; } const sortedUsers = Object.entries(allUsers).sort(([, a], [, b]) => (a.name || '').localeCompare(b.name || '')); sortedUsers.forEach(([uid, user]) => { const row = userManagementTableBody.insertRow(); row.dataset.userId = uid; const isCurrentUser = uid === currentUser.uid; row.innerHTML = ` <td data-key="name">${user.name || ''}</td> <td data-key="email">${user.email || ''}</td> <td data-key="status" style="color: ${user.status === 'approved' ? 'green' : 'orange'}; font-weight: bold;"> ${user.status || 'pendente'} </td> <td data-key="role" style="font-weight: bold;"> ${user.role || 'user'} </td> <td data-key="actions"> ${user.status !== 'approved' ? `<button class="button button-small button-success" data-action="approve" style="padding: 5px 8px;">Aprovar</button>` : ''} ${user.role !== 'admin' ? `<button class="button button-small button-admin" data-action="makeAdmin" style="padding: 5px 8px;">Tornar Admin</button>` : ''} ${user.role === 'admin' && !isCurrentUser ? `<button class="button button-small" data-action="revokeAdmin" style="background-color: var(--cor-aviso); color: #333; padding: 5px 8px;">Revogar Admin</button>` : ''} </td> `; }); }
            userManagementTableBody.addEventListener('click', async (e) => { if (e.target.tagName === 'BUTTON') { const action = e.target.dataset.action; const row = e.target.closest('tr'); const userId = row.dataset.userId; if (!userId || !action) return; try { let updates = {}; if (action === 'approve') updates[`users/${userId}/status`] = 'approved'; else if (action === 'makeAdmin') updates[`users/${userId}/role`] = 'admin'; else if (action === 'revokeAdmin') { if (userId === currentUser.uid) { showToast("Não pode revogar a si mesmo.", "warning"); return; } updates[`users/${userId}/role`] = 'user'; } if (Object.keys(updates).length > 0) { await update(ref(db), updates); if (action === 'approve') allUsers[userId].status = 'approved'; if (action === 'makeAdmin') allUsers[userId].role = 'admin'; if (action === 'revokeAdmin') allUsers[userId].role = 'user'; renderUserManagementTable(); } } catch (error) { showToast(`Erro: ${error.message}`); } } });
            
            // REMOVIDO: adminGestaoEtapasBtn e suas funções (stepProcessTypeSelect, loadStepsForEditing, renderStepsList, addStepBtn, editStepBtn, removeStepBtn, showStepEditModal, saveStepBtn, stepEditNameInput, saveStepsBtn)


            // --- LÓGICA GERAL DE MODAIS E STATUS ---
            
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', () => {
                    const modalId = btn.dataset.modalId;
                    if (modalId === 'confirm-modal') {
                        confirmModalCancelBtn.click();
                    } else {
                        closeModal(modalId);
                    }
                });
            });
            
            window.addEventListener('click', (event) => { 
                if (event.target.classList.contains('modal')) {
                    if (event.target.id === 'confirm-modal') {
                        confirmModalCancelBtn.click();
                    } else {
                        // Não fecha o modal de filtro ao clicar fora
                        if (event.target.id !== 'filter-modal') {
                             event.target.style.display = "none";
                        }
                    }
                }
            });
            
            function closeModal(modalId) { 
                const modal = document.getElementById(modalId); 
                if (modal) { 
                    modal.style.display = "none"; 
                    if (modalId === 'register-modal') { 
                        document.getElementById('register-name').value = ""; 
                        document.getElementById('register-email').value = ""; 
                        document.getElementById('register-password').value = ""; 
                        document.getElementById('register-confirm-password').value = ""; 
                        showRegisterStatus("", "success"); 
                    } 
                    // REMOVIDO: Limpeza do 'process-modal'
                    if (modalId === 'recuperacao-form-modal') { 
                        recuperacaoForm.reset(); 
                        recuperacaoStatus.textContent = "";
                        recDocIdInput.value = "";
                        recInteressadoList.innerHTML = ""; // Limpa a lista de interessados
                        document.getElementById('recuperacao-modal-title').textContent = "Registo/Recuperação Docs";
                        document.getElementById('recuperacao-delete-btn').classList.add('hidden');
                    } 
                    if (modalId === 'send-message-modal') { sendMessageContent.value=""; sendMessageStatus.textContent=""; } 
                    // REMOVIDO: Limpeza do 'color-rule-modal'
                    if (modalId === 'tag-edit-modal') tagEditForm.reset(); 
                    // REMOVIDO: Limpeza do 'step-edit-modal'
                    // REMOVIDO: Limpeza do 'step-management-modal'
                } 
            }
            function showLoginStatus(message, type) { loginStatus.textContent = message; loginStatus.className = `status-${type}`; }
            function showRegisterStatus(message, type) { registerStatus.textContent = message; registerStatus.className = `status-${type}`; }

        // ======================================================
        // ==== FIM DO CÓDIGO A SER ENVOLVIDO ====
        // ======================================================
        }); // <-- CHAVE DE FECHO DO DOMContentLoaded

    </script>
</body>

</html>
